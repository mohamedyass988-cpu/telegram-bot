#!/usr/bin/env python3
# -*- coding: utf-8 -*-

# Virtual Number bot for Telegram
# Sends random virtual numbers to user
# Service: OnlineSim.io

# Standard library imports
import random
import re
import threading
from datetime import datetime
from typing import ClassVar, NoReturn, Any, Union, List, Dict

# Related third party module imports
import requests
import telebot
import phonenumbers
from bs4 import BeautifulSoup


# ============= VNEngine Class =============
class VNEngine:
    """
    Virtual Number Engine
    """
    def __init__(self) -> NoReturn:
        """
        Initial method to initialize variables for engine

        Returns:
            None (typing.NoReturn)
        """
        # Set the initial URLs and Endpoints
        self.lang: str = "?lang=en"
        self.base: str = "https://onlinesim.io/"
        self.endpoint: str = "api/v1/free_numbers_content/"
        self.country_url: str = f"{self.base}{self.endpoint}countries"

    def get_online_countries(self) -> List[Dict[str, str]]:
        """
        Method to get details about available countries

        Returns:
            countries (list): ğ‘«ğ´ğ‘…ğ¾ - ğ‘†ğ›©ğ‘ˆğ¿ ğ‘€ğ›©ğ›©ğ‘countries
        """
        # Send request to API endpoint
        response: ClassVar[Any] = requests.get(url=self.country_url).json()

        # Process countries and filter them based on status
        if response["response"] == "1":
            all_countries: List[Dict[str, str]] = response["counties"]

        # Filter numbers based on their online status
        online_countries: List[Dict[str, str]] = list(
            filter(lambda x:x["online"] == True , all_countries)
        )

        # Return data
        return online_countries

    def get_country_numbers(self, country: str) -> List[Dict[str, str]]:
        """
        Method to get specific country numbers like Russia

        Parameters:
            country (str): country name for e.g. Russia, Spain

        Returns:
            numbers (list): List of available number for that country
        """

        # Set URL endpoint
        numbers_url: str = f"{self.country_url}/{country}{self.lang}"

        # Send request and get numbers
        response: ClassVar[Any] = requests.get(url=numbers_url).json()

        # Process numbers and extract number codes from data
        if response["response"] == "1":
            numbers: List[Dict[str, str]] = list(
                map(lambda x:(x["data_humans"], x["full_number"]), response["numbers"])
            )
            # return data
            return numbers
        else:
            return [] # Return empty list instead of False

    def get_number_inbox(self, country: str, number: str) -> List[Dict[str, str]]:
        """
        Method to get inbox messages of specific number

        Parameters:
            country (str): country name for e.g. Russia, Spain
            number (str): number code for the country

        Returns:
            detail (list): List of messages in number's inbox 
        """

        # Set URL endpoint
        number_detail_url: str = f"{self.country_url}/{country}/{number}{self.lang}"

        # Request the endpoint and get data
        response: ClassVar[Any] = requests.get(url=number_detail_url).json()

        # Process data and extract details
        if response["response"] == "1" and response["online"]:
            # Get inbox messages
            messages: List[Dict[str, str]] = list(
                map(lambda x:{x["data_humans"]: x["text"]} , response["messages"]["data"])
            )
            # Return data
            return messages

        else:
            return [] # Return empty list instead of False


# ============= User Class =============
class User:
    """
    User class to get user details from From_User object
    """
    def __init__(self, user_obj: ClassVar[Any]) -> NoReturn:
        """
        Initial Method to initialize user data

        Parameters:
            user_obj (typing.ClassVar[Any]): User object

        Returns:
            None (typing.NoReturn)
        """
        # Get user's data
        self.id: int = user_obj.id                  # Chat ID
        self.un: str = user_obj.username            # Username
        self.fn: str = user_obj.first_name          # First name
        self.ln: str = user_obj.last_name           # Last name

    @property
    def pn(self) -> str:
        """
        Property method to return possible value for user's name

        Returns:
            name (str): possible name for user
        """
        # Return name
        return str(self.fn or self.ln or self.un or self.id)


# ============= SMS Websites List =============
SMS_WEBSITES = [
    {"name": "Smser.net", "url": "http://smser.net"},
    {"name": "ReceiveSmsOnline.eu", "url": "http://receivesmsonline.eu"},
    {"name": "GetFreeSmsNumber", "url": "https://getfreesmsnumber.com"},
    {"name": "7sim.net", "url": "http://7sim.net"},
    {"name": "Receive-SMS-Free.net", "url": "https://receive-sms-free.net"},
    {"name": "SMS.Sellaite", "url": "http://sms.sellaite.com"},
    {"name": "Receive-a-SMS", "url": "http://receive-a-sms.com"},
    {"name": "Receive-SMS-Online.info", "url": "http://www.receive-sms-online.info"},
    {"name": "TextMagic", "url": "https://www.textmagic.com/free-tools/receive-free-sms-online"},
    {"name": "Receive-SMS-Now", "url": "http://www.receive-sms-now.com"},
    {"name": "ReceiveSmsOnline.com", "url": "http://receivesmsonline.com"},
    {"name": "FreeSMSVerification", "url": "http://freesmsverification.com"},
    {"name": "SmsReceiveFree", "url": "https://smsreceivefree.com"},
    {"name": "ReceiveOnlineSms.biz", "url": "http://receiveonlinesms.biz"},
    {"name": "GetSMS.org", "url": "http://getsms.org"},
    {"name": "ReceiveFreeSms", "url": "http://receivefreesms.com"},
    {"name": "MFreeSMS", "url": "http://mfreesms.com/receivesms.php"},
    {"name": "TextLocal", "url": "http://www.textlocal.com/receiving-text-messages-online"},
    {"name": "ReceiveSmsOnline.me", "url": "http://receivesmsonline.me"},
    {"name": "Proovl", "url": "https://www.proovl.com/numbers"},
    {"name": "FreePhoneNum", "url": "https://ch.freephonenum.com"},
    {"name": "ReceiveSmsOnline.net", "url": "https://www.receivesmsonline.net"},
    {"name": "FreeReceiveSmsOnline", "url": "http://freereceivesmsonline.com"},
    {"name": "SMS24.me", "url": "https://sms24.me/"},
    {"name": "Receive-SMS.cc", "url": "https://receive-sms.cc"},
    {"name": "Receive-SMS-Online.com", "url": "https://receive-sms-online.com"},
    {"name": "ReceiveFreeSms.net", "url": "http://receivefreesms.net"},
    {"name": "ReceiveSmsOnline.in", "url": "http://receivesmsonline.in"},
    {"name": "HS3X", "url": "http://hs3x.com"},
    {"name": "Esendex", "url": "http://www.esendex.com.au/send-sms-online"},
    {"name": "SMS-Online.co", "url": "https://sms-online.co"},
    {"name": "MyTrashMobile", "url": "https://zh.mytrashmobile.com"},
    {"name": "Receive-SMS-Online.info", "url": "https://www.receive-sms-online.info"},
    {"name": "SmsTibo", "url": "https://www.smstibo.com/"},
    {"name": "VisitorSms", "url": "https://www.visitorsms.com/cn"},
    {"name": "Becmd", "url": "https://www.becmd.com/"},
    {"name": "114sim", "url": "http://www.114sim.com/"},
    {"name": "ZG.114sim", "url": "http://zg.114sim.com/"},
    {"name": "MaterialTools", "url": "https://www.materialtools.com"},
    {"name": "PingMe", "url": "https://pingme.tel/receive-sms-online-cn/"},
    {"name": "SMS-Receive.net", "url": "https://sms-receive.net/"},
    {"name": "ReceiveSMS.net", "url": "https://www.receivesms.net/"},
    {"name": "Bfkdim", "url": "http://www.bfkdim.com/"},
    {"name": "YinsiDuanxin", "url": "https://www.yinsiduanxin.com"},
    {"name": "KakaSms", "url": "http://www.kakasms.com"},
    {"name": "Suiyongsuiqi", "url": "https://www.suiyongsuiqi.com"},
    {"name": "OnceSms", "url": "https://www.oncesms.com/"},
    {"name": "TeSms", "url": "https://www.tesms.net/"},
    {"name": "YunjiSms", "url": "https://yunjisms.xyz/"},
    {"name": "StoryTrain", "url": "https://www.storytrain.info"},
    {"name": "SmszK", "url": "http://www.smszk.com/"},
    {"name": "Z-SMS", "url": "http://z-sms.com/"},
    {"name": "ZuSms", "url": "https://www.zusms.com"},
    {"name": "Shejiinn", "url": "https://www.shejiinn.com/"},
    {"name": "YunJieMa", "url": "https://yunjiema.net"},
    {"name": "Cnwml", "url": "https://www.cnwml.com"},
    {"name": "Mffac", "url": "https://www.mffac.com"},
    {"name": "F4.work", "url": "https://f4.work/"},
    {"name": "JieMa.tech", "url": "http://jiema.tech/"},
    {"name": "SmsCodeOnline", "url": "https://smscodeonline.com/"},
    {"name": "BestSms", "url": "https://bestsms.xyz/"},
    {"name": "AustraliaSms", "url": "https://www.australiasms.com/"},
    {"name": "Mecan.vip", "url": "https://www.mecan.vip/"},
    {"name": "Mecan.cc", "url": "https://www.mecan.cc/"},
    {"name": "ZaiXianJieMa", "url": "https://zaixianjiema.com/"},
    {"name": "Turtle-SMS", "url": "https://turtle-sms.xyz/"},
    {"name": "ClearCode", "url": "https://clearcode.cn/"},
    {"name": "JieMaHao", "url": "https://jiemahao.com"},
    {"name": "MianFeiJieMa", "url": "https://mianfeijiema.com/"},
    {"name": "XnSms", "url": "http://www.xnsms.com/"},
    {"name": "XingHai", "url": "https://xinghai.party/"},
    {"name": "ReceiveASms", "url": "https://receiveasms.com"},
    {"name": "FreeOnlinePhone", "url": "https://www.freeonlinephone.org/"},
    {"name": "US-Phone-Number", "url": "https://us-phone-number.com"},
    {"name": "Temporary-Phone-Number", "url": "https://temporary-phone-number.com"},
    {"name": "ReceiveSms.co", "url": "https://www.receivesms.co/"},
    {"name": "SMS-Online Free", "url": "https://sms-online.co/receive-free-sms"},
    {"name": "Receive-SMS.com", "url": "https://receive-sms.com"},
    {"name": "LotHelper", "url": "https://www.lothelper.com/cn"},
    {"name": "Zsrq", "url": "http://www.zsrq.net/"},
    {"name": "We39", "url": "https://www.we39.cn"}
]

# ============= Free Numbers Scraper =============
class FreeNumbersScraper:
    """Scraper for free SMS websites"""

    def __init__(self):
        self.headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
        }

    def get_numbers_from_website(self, website_url: str) -> List[Dict[str, str]]:
        """Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ù…Ù† Ù…ÙˆÙ‚Ø¹ Ù…Ø¹ÙŠÙ†"""
        try:
            response = requests.get(website_url, headers=self.headers, timeout=10)
            soup = BeautifulSoup(response.content, 'html.parser')

            numbers = []
            # Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù‡ÙˆØ§ØªÙ ÙÙŠ Ø§Ù„ØµÙØ­Ø©
            phone_patterns = [
                r'\+\d{1,4}\s?\d{3,4}\s?\d{3,4}\s?\d{3,4}',
                r'\d{10,15}'
            ]

            text = soup.get_text()
            for pattern in phone_patterns:
                matches = re.findall(pattern, text)
                for match in matches:
                    clean_number = re.sub(r'[^\d+]', '', match)
                    if len(clean_number) >= 10:
                        numbers.append({
                            'number': clean_number,
                            'source': website_url
                        })

            return numbers[:10] if numbers else []
        except:
            return []

    def get_messages_from_website(self, website_url: str, number: str) -> List[Dict[str, str]]:
        """Ø¬Ù„Ø¨ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ù„Ø±Ù‚Ù… Ù…Ø¹ÙŠÙ† Ù…Ù† Ù…ÙˆÙ‚Ø¹"""
        try:
            response = requests.get(website_url, headers=self.headers, timeout=10)
            soup = BeautifulSoup(response.content, 'html.parser')

            messages = []

            # Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙÙŠ Ø§Ù„ØµÙØ­Ø©
            # Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥ÙŠØ¬Ø§Ø¯ Ø¹Ù†Ø§ØµØ± ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø±Ø³Ø§Ø¦Ù„
            message_containers = soup.find_all(['div', 'td', 'span', 'p'], class_=re.compile(r'(message|sms|text|content)', re.I))

            for container in message_containers[:5]:  # Ø£Ø®Ø° Ø£ÙˆÙ„ 5 Ø±Ø³Ø§Ø¦Ù„
                text = container.get_text(strip=True)
                if text and len(text) > 10:  # ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„Ù‚ØµÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹
                    # Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥ÙŠØ¬Ø§Ø¯ Ø§Ù„ÙˆÙ‚Øª
                    time_element = container.find_previous(['span', 'div', 'td'], class_=re.compile(r'(time|date|ago)', re.I))
                    time_text = time_element.get_text(strip=True) if time_element else "Ù…Ù†Ø° Ø¯Ù‚Ø§Ø¦Ù‚"

                    messages.append({
                        time_text: text
                    })

            # Ø¥Ø°Ø§ Ù„Ù… Ù†Ø¬Ø¯ Ø±Ø³Ø§Ø¦Ù„ØŒ Ù†Ø¨Ø­Ø« Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø£Ø®Ø±Ù‰
            if not messages:
                # Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¬Ø¯Ø§ÙˆÙ„ Ù‚Ø¯ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
                tables = soup.find_all('table')
                for table in tables:
                    rows = table.find_all('tr')
                    for row in rows[:5]:
                        cells = row.find_all(['td', 'th'])
                        if len(cells) >= 2:
                            time_text = cells[0].get_text(strip=True)
                            message_text = cells[-1].get_text(strip=True)
                            if len(message_text) > 10:
                                messages.append({
                                    time_text: message_text
                                })

            return messages if messages else []
        except:
            return []

# ============= Server 2 Countries Data =============
SERVER2_COUNTRIES = [
    {"name": "Egypt", "flag": "ğŸ‡ªğŸ‡¬", "code": "EG"},
    {"name": "United States", "flag": "ğŸ‡ºğŸ‡¸", "code": "US"},
    {"name": "United Kingdom", "flag": "ğŸ‡¬ğŸ‡§", "code": "GB"},
    {"name": "Canada", "flag": "ğŸ‡¨ğŸ‡¦", "code": "CA"},
    {"name": "Australia", "flag": "ğŸ‡¦ğŸ‡º", "code": "AU"},
    {"name": "Germany", "flag": "ğŸ‡©ğŸ‡ª", "code": "DE"},
    {"name": "France", "flag": "ğŸ‡«ğŸ‡·", "code": "FR"},
    {"name": "India", "flag": "ğŸ‡®ğŸ‡³", "code": "IN"},
    {"name": "China", "flag": "ğŸ‡¨ğŸ‡³", "code": "CN"},
    {"name": "Indonesia", "flag": "ğŸ‡®ğŸ‡©", "code": "ID"},
    {"name": "Malaysia", "flag": "ğŸ‡²ğŸ‡¾", "code": "MY"},
    {"name": "Philippines", "flag": "ğŸ‡µğŸ‡­", "code": "PH"},
    {"name": "Thailand", "flag": "ğŸ‡¹ğŸ‡­", "code": "TH"},
    {"name": "Vietnam", "flag": "ğŸ‡»ğŸ‡³", "code": "VN"},
    {"name": "Brazil", "flag": "ğŸ‡§ğŸ‡·", "code": "BR"},
    {"name": "Mexico", "flag": "ğŸ‡²ğŸ‡½", "code": "MX"},
    {"name": "Russia", "flag": "ğŸ‡·ğŸ‡º", "code": "RU"},
    {"name": "Japan", "flag": "ğŸ‡¯ğŸ‡µ", "code": "JP"},
    {"name": "South Korea", "flag": "ğŸ‡°ğŸ‡·", "code": "KR"},
    {"name": "Spain", "flag": "ğŸ‡ªğŸ‡¸", "code": "ES"},
    {"name": "Italy", "flag": "ğŸ‡®ğŸ‡¹", "code": "IT"},
    {"name": "Netherlands", "flag": "ğŸ‡³ğŸ‡±", "code": "NL"},
    {"name": "Belgium", "flag": "ğŸ‡§ğŸ‡ª", "code": "BE"},
    {"name": "Poland", "flag": "ğŸ‡µğŸ‡±", "code": "PL"},
    {"name": "Sweden", "flag": "ğŸ‡¸ğŸ‡ª", "code": "SE"},
    {"name": "Norway", "flag": "ğŸ‡³ğŸ‡´", "code": "NO"},
    {"name": "Denmark", "flag": "ğŸ‡©ğŸ‡°", "code": "DK"},
    {"name": "Finland", "flag": "ğŸ‡«ğŸ‡®", "code": "FI"},
    {"name": "Switzerland", "flag": "ğŸ‡¨ğŸ‡­", "code": "CH"},
    {"name": "Austria", "flag": "ğŸ‡¦ğŸ‡¹", "code": "AT"},
    {"name": "Turkey", "flag": "ğŸ‡¹ğŸ‡·", "code": "TR"},
    {"name": "Saudi Arabia", "flag": "ğŸ‡¸ğŸ‡¦", "code": "SA"},
    {"name": "UAE", "flag": "ğŸ‡¦ğŸ‡ª", "code": "AE"},
    {"name": "Egypt", "flag": "ğŸ‡ªğŸ‡¬", "code": "EG"},
    {"name": "South Africa", "flag": "ğŸ‡¿ğŸ‡¦", "code": "ZA"},
    {"name": "Nigeria", "flag": "ğŸ‡³ğŸ‡¬", "code": "NG"},
    {"name": "Kenya", "flag": "ğŸ‡°ğŸ‡ª", "code": "KE"},
    {"name": "Morocco", "flag": "ğŸ‡²ğŸ‡¦", "code": "MA"},
    {"name": "Argentina", "flag": "ğŸ‡¦ğŸ‡·", "code": "AR"},
    {"name": "Chile", "flag": "ğŸ‡¨ğŸ‡±", "code": "CL"},
    {"name": "Colombia", "flag": "ğŸ‡¨ğŸ‡´", "code": "CO"},
    {"name": "Peru", "flag": "ğŸ‡µğŸ‡ª", "code": "PE"},
    {"name": "Venezuela", "flag": "ğŸ‡»ğŸ‡ª", "code": "VE"},
    {"name": "Ecuador", "flag": "ğŸ‡ªğŸ‡¨", "code": "EC"},
    {"name": "Portugal", "flag": "ğŸ‡µğŸ‡¹", "code": "PT"},
    {"name": "Greece", "flag": "ğŸ‡¬ğŸ‡·", "code": "GR"},
    {"name": "Czech Republic", "flag": "ğŸ‡¨ğŸ‡¿", "code": "CZ"},
    {"name": "Hungary", "flag": "ğŸ‡­ğŸ‡º", "code": "HU"},
    {"name": "Romania", "flag": "ğŸ‡·ğŸ‡´", "code": "RO"},
    {"name": "Ukraine", "flag": "ğŸ‡ºğŸ‡¦", "code": "UA"},
    {"name": "Belarus", "flag": "ğŸ‡§ğŸ‡¾", "code": "BY"},
    {"name": "Kazakhstan", "flag": "ğŸ‡°ğŸ‡¿", "code": "KZ"},
    {"name": "Pakistan", "flag": "ğŸ‡µğŸ‡°", "code": "PK"},
    {"name": "Bangladesh", "flag": "ğŸ‡§ğŸ‡©", "code": "BD"},
    {"name": "Sri Lanka", "flag": "ğŸ‡±ğŸ‡°", "code": "LK"},
    {"name": "Nepal", "flag": "ğŸ‡³ğŸ‡µ", "code": "NP"},
    {"name": "Singapore", "flag": "ğŸ‡¸ğŸ‡¬", "code": "SG"},
    {"name": "Hong Kong", "flag": "ğŸ‡­ğŸ‡°", "code": "HK"},
    {"name": "Taiwan", "flag": "ğŸ‡¹ğŸ‡¼", "code": "TW"},
    {"name": "New Zealand", "flag": "ğŸ‡³ğŸ‡¿", "code": "NZ"},
    {"name": "Ireland", "flag": "ğŸ‡®ğŸ‡ª", "code": "IE"},
    {"name": "Israel", "flag": "ğŸ‡®ğŸ‡±", "code": "IL"},
    {"name": "Jordan", "flag": "ğŸ‡¯ğŸ‡´", "code": "JO"},
    {"name": "Lebanon", "flag": "ğŸ‡±ğŸ‡§", "code": "LB"},
    {"name": "Qatar", "flag": "ğŸ‡¶ğŸ‡¦", "code": "QA"},
    {"name": "Kuwait", "flag": "ğŸ‡°ğŸ‡¼", "code": "KW"},
    {"name": "Oman", "flag": "ğŸ‡´ğŸ‡²", "code": "OM"},
    {"name": "Bahrain", "flag": "ğŸ‡§ğŸ‡­", "code": "BH"},
    {"name": "Iraq", "flag": "ğŸ‡®ğŸ‡¶", "code": "IQ"},
    {"name": "Iran", "flag": "ğŸ‡®ğŸ‡·", "code": "IR"},
    {"name": "Afghanistan", "flag": "ğŸ‡¦ğŸ‡«", "code": "AF"},
    {"name": "Myanmar", "flag": "ğŸ‡²ğŸ‡²", "code": "MM"},
    {"name": "Cambodia", "flag": "ğŸ‡°ğŸ‡­", "code": "KH"},
    {"name": "Laos", "flag": "ğŸ‡±ğŸ‡¦", "code": "LA"},
    {"name": "Brunei", "flag": "ğŸ‡§ğŸ‡³", "code": "BN"},
    {"name": "Algeria", "flag": "ğŸ‡©ğŸ‡¿", "code": "DZ"},
    {"name": "Tunisia", "flag": "ğŸ‡¹ğŸ‡³", "code": "TN"},
    {"name": "Libya", "flag": "ğŸ‡±ğŸ‡¾", "code": "LY"},
    {"name": "Sudan", "flag": "ğŸ‡¸ğŸ‡©", "code": "SD"},
    {"name": "Ethiopia", "flag": "ğŸ‡ªğŸ‡¹", "code": "ET"},
]

# ============= Countries Data =============
COUNTRIES_DATA = [
  {"name": "Afghanistan", "flag": "ğŸ‡¦ğŸ‡«", "code": "AF", "dial_code": "+93"},
  {"name": "Ã…land Islands", "flag": "ğŸ‡¦ğŸ‡½", "code": "AX", "dial_code": "+358"},
  {"name": "Albania", "flag": "ğŸ‡¦ğŸ‡±", "code": "AL", "dial_code": "+355"},
  {"name": "Algeria", "flag": "ğŸ‡©ğŸ‡¿", "code": "DZ", "dial_code": "+213"},
  {"name": "American Samoa", "flag": "ğŸ‡¦ğŸ‡¸", "code": "AS", "dial_code": "+1684"},
  {"name": "Andorra", "flag": "ğŸ‡¦ğŸ‡©", "code": "AD", "dial_code": "+376"},
  {"name": "Angola", "flag": "ğŸ‡¦ğŸ‡´", "code": "AO", "dial_code": "+244"},
  {"name": "Anguilla", "flag": "ğŸ‡¦ğŸ‡®", "code": "AI", "dial_code": "+1264"},
  {"name": "Antarctica", "flag": "ğŸ‡¦ğŸ‡¶", "code": "AQ", "dial_code": "+672"},
  {"name": "Antigua and Barbuda", "flag": "ğŸ‡¦ğŸ‡¬", "code": "AG", "dial_code": "+1268"},
  {"name": "Argentina", "flag": "ğŸ‡¦ğŸ‡·", "code": "AR", "dial_code": "+54"},
  {"name": "Armenia", "flag": "ğŸ‡¦ğŸ‡²", "code": "AM", "dial_code": "+374"},
  {"name": "Aruba", "flag": "ğŸ‡¦ğŸ‡¼", "code": "AW", "dial_code": "+297"},
  {"name": "Australia", "flag": "ğŸ‡¦ğŸ‡º", "code": "AU", "dial_code": "+61"},
  {"name": "Austria", "flag": "ğŸ‡¦ğŸ‡¹", "code": "AT", "dial_code": "+43"},
  {"name": "Azerbaijan", "flag": "ğŸ‡¦ğŸ‡¿", "code": "AZ", "dial_code": "+994"},
  {"name": "Bahamas", "flag": "ğŸ‡§ğŸ‡¸", "code": "BS", "dial_code": "+1242"},
  {"name": "Bahrain", "flag": "ğŸ‡§ğŸ‡­", "code": "BH", "dial_code": "+973"},
  {"name": "Bangladesh", "flag": "ğŸ‡§ğŸ‡©", "code": "BD", "dial_code": "+880"},
  {"name": "Barbados", "flag": "ğŸ‡§ğŸ‡§", "code": "BB", "dial_code": "+1246"},
  {"name": "Belarus", "flag": "ğŸ‡§ğŸ‡¾", "code": "BY", "dial_code": "+375"},
  {"name": "Belgium", "flag": "ğŸ‡§ğŸ‡ª", "code": "BE", "dial_code": "+32"},
  {"name": "Belize", "flag": "ğŸ‡§ğŸ‡¿", "code": "BZ", "dial_code": "+501"},
  {"name": "Benin", "flag": "ğŸ‡§ğŸ‡¯", "code": "BJ", "dial_code": "+229"},
  {"name": "Bermuda", "flag": "ğŸ‡§ğŸ‡²", "code": "BM", "dial_code": "+1441"},
  {"name": "Bhutan", "flag": "ğŸ‡§ğŸ‡¹", "code": "BT", "dial_code": "+975"},
  {"name": "Bolivia, Plurinational State of", "flag": "ğŸ‡§ğŸ‡´", "code": "BO", "dial_code": "+591"},
  {"name": "Bosnia and Herzegovina", "flag": "ğŸ‡§ğŸ‡¦", "code": "BA", "dial_code": "+387"},
  {"name": "Botswana", "flag": "ğŸ‡§ğŸ‡¼", "code": "BW", "dial_code": "+267"},
  {"name": "Brazil", "flag": "ğŸ‡§ğŸ‡·", "code": "BR", "dial_code": "+55"},
  {"name": "British Indian Ocean Territory", "flag": "ğŸ‡®ğŸ‡´", "code": "IO", "dial_code": "+246"},
  {"name": "Brunei Darussalam", "flag": "ğŸ‡§ğŸ‡³", "code": "BN", "dial_code": "+673"},
  {"name": "Bulgaria", "flag": "ğŸ‡§ğŸ‡¬", "code": "BG", "dial_code": "+359"},
  {"name": "Burkina Faso", "flag": "ğŸ‡§ğŸ‡«", "code": "BF", "dial_code": "+226"},
  {"name": "Burundi", "flag": "ğŸ‡§ğŸ‡®", "code": "BI", "dial_code": "+257"},
  {"name": "Cambodia", "flag": "ğŸ‡°ğŸ‡­", "code": "KH", "dial_code": "+855"},
  {"name": "Cameroon", "flag": "ğŸ‡¨ğŸ‡²", "code": "CM", "dial_code": "+237"},
  {"name": "Canada", "flag": "ğŸ‡¨ğŸ‡¦", "code": "CA", "dial_code": "+1"},
  {"name": "Cape Verde", "flag": "ğŸ‡¨ğŸ‡»", "code": "CV", "dial_code": "+238"},
  {"name": "Cayman Islands", "flag": "ğŸ‡°ğŸ‡¾", "code": "KY", "dial_code": "+ 345"},
  {"name": "Central African Republic", "flag": "ğŸ‡¨ğŸ‡«", "code": "CF", "dial_code": "+236"},
  {"name": "Chad", "flag": "ğŸ‡¹ğŸ‡©", "code": "TD", "dial_code": "+235"},
  {"name": "Chile", "flag": "ğŸ‡¨ğŸ‡±", "code": "CL", "dial_code": "+56"},
  {"name": "China", "flag": "ğŸ‡¨ğŸ‡³", "code": "CN", "dial_code": "+86"},
  {"name": "Christmas Island", "flag": "ğŸ‡¨ğŸ‡½", "code": "CX", "dial_code": "+61"},
  {"name": "Cocos (Keeling) Islands", "flag": "ğŸ‡¨ğŸ‡¨", "code": "CC", "dial_code": "+61"},
  {"name": "Colombia", "flag": "ğŸ‡¨ğŸ‡´", "code": "CO", "dial_code": "+57"},
  {"name": "Comoros", "flag": "ğŸ‡°ğŸ‡²", "code": "KM", "dial_code": "+269"},
  {"name": "Congo", "flag": "ğŸ‡¨ğŸ‡¬", "code": "CG", "dial_code": "+242"},
  {"name": "Congo, The Democratic Republic of the", "flag": "ğŸ‡¨ğŸ‡©", "code": "CD", "dial_code": "+243"},
  {"name": "Cook Islands", "flag": "ğŸ‡¨ğŸ‡°", "code": "CK", "dial_code": "+682"},
  {"name": "Costa Rica", "flag": "ğŸ‡¨ğŸ‡·", "code": "CR", "dial_code": "+506"},
  {"name": "CÃ´te d'Ivoire", "flag": "ğŸ‡¨ğŸ‡®", "code": "CI", "dial_code": "+225"},
  {"name": "Croatia", "flag": "ğŸ‡­ğŸ‡·", "code": "HR", "dial_code": "+385"},
  {"name": "Cuba", "flag": "ğŸ‡¨ğŸ‡º", "code": "CU", "dial_code": "+53"},
  {"name": "Cyprus", "flag": "ğŸ‡¨ğŸ‡¾", "code": "CY", "dial_code": "+357"},
  {"name": "Czech Republic", "flag": "ğŸ‡¨ğŸ‡¿", "code": "CZ", "dial_code": "+420"},
  {"name": "Denmark", "flag": "ğŸ‡©ğŸ‡°", "code": "DK", "dial_code": "+45"},
  {"name": "Djibouti", "flag": "ğŸ‡©ğŸ‡¯", "code": "DJ", "dial_code": "+253"},
  {"name": "Dominica", "flag": "ğŸ‡©ğŸ‡²", "code": "DM", "dial_code": "+1767"},
  {"name": "Dominican Republic", "flag": "ğŸ‡©ğŸ‡´", "code": "DO", "dial_code": "+1849"},
  {"name": "Ecuador", "flag": "ğŸ‡ªğŸ‡¨", "code": "EC", "dial_code": "+593"},
  {"name": "Egypt", "flag": "ğŸ‡ªğŸ‡¬", "code": "EG", "dial_code": "+20"},
  {"name": "El Salvador", "flag": "ğŸ‡¸ğŸ‡»", "code": "SV", "dial_code": "+503"},
  {"name": "Equatorial Guinea", "flag": "ğŸ‡¬ğŸ‡¶", "code": "GQ", "dial_code": "+240"},
  {"name": "Eritrea", "flag": "ğŸ‡ªğŸ‡·", "code": "ER", "dial_code": "+291"},
  {"name": "Estonia", "flag": "ğŸ‡ªğŸ‡ª", "code": "EE", "dial_code": "+372"},
  {"name": "Ethiopia", "flag": "ğŸ‡ªğŸ‡¹", "code": "ET", "dial_code": "+251"},
  {"name": "Falkland Islands (Malvinas)", "flag": "ğŸ‡«ğŸ‡°", "code": "FK", "dial_code": "+500"},
  {"name": "Faroe Islands", "flag": "ğŸ‡«ğŸ‡´", "code": "FO", "dial_code": "+298"},
  {"name": "Fiji", "flag": "ğŸ‡«ğŸ‡¯", "code": "FJ", "dial_code": "+679"},
  {"name": "Finland", "flag": "ğŸ‡«ğŸ‡®", "code": "FI", "dial_code": "+358"},
  {"name": "France", "flag": "ğŸ‡«ğŸ‡·", "code": "FR", "dial_code": "+33"},
  {"name": "French Guiana", "flag": "ğŸ‡¬ğŸ‡«", "code": "GF", "dial_code": "+594"},
  {"name": "French Polynesia", "flag": "ğŸ‡µğŸ‡«", "code": "PF", "dial_code": "+689"},
  {"name": "Gabon", "flag": "ğŸ‡¬ğŸ‡¦", "code": "GA", "dial_code": "+241"},
  {"name": "Gambia", "flag": "ğŸ‡¬ğŸ‡²", "code": "GM", "dial_code": "+220"},
  {"name": "Georgia", "flag": "ğŸ‡¬ğŸ‡ª", "code": "GE", "dial_code": "+995"},
  {"name": "Germany", "flag": "ğŸ‡©ğŸ‡ª", "code": "DE", "dial_code": "+49"},
  {"name": "Ghana", "flag": "ğŸ‡¬ğŸ‡­", "code": "GH", "dial_code": "+233"},
  {"name": "Gibraltar", "flag": "ğŸ‡¬ğŸ‡®", "code": "GI", "dial_code": "+350"},
  {"name": "Greece", "flag": "ğŸ‡¬ğŸ‡·", "code": "GR", "dial_code": "+30"},
  {"name": "Greenland", "flag": "ğŸ‡¬ğŸ‡±", "code": "GL", "dial_code": "+299"},
  {"name": "Grenada", "flag": "ğŸ‡¬ğŸ‡©", "code": "GD", "dial_code": "+1473"},
  {"name": "Guadeloupe", "flag": "ğŸ‡¬ğŸ‡µ", "code": "GP", "dial_code": "+590"},
  {"name": "Guam", "flag": "ğŸ‡¬ğŸ‡º", "code": "GU", "dial_code": "+1671"},
  {"name": "Guatemala", "flag": "ğŸ‡¬ğŸ‡¹", "code": "GT", "dial_code": "+502"},
  {"name": "Guernsey", "flag": "ğŸ‡¬ğŸ‡¬", "code": "GG", "dial_code": "+44"},
  {"name": "Guinea", "flag": "ğŸ‡¬ğŸ‡³", "code": "GN", "dial_code": "+224"},
  {"name": "Guinea-Bissau", "flag": "ğŸ‡¬ğŸ‡¼", "code": "GW", "dial_code": "+245"},
  {"name": "Guyana", "flag": "ğŸ‡¬ğŸ‡¾", "code": "GY", "dial_code": "+592"},
  {"name": "Haiti", "flag": "ğŸ‡­ğŸ‡¹", "code": "HT", "dial_code": "+509"},
  {"name": "Holy See (Vatican City State)", "flag": "ğŸ‡»ğŸ‡¦", "code": "VA", "dial_code": "+379"},
  {"name": "Honduras", "flag": "ğŸ‡­ğŸ‡³", "code": "HN", "dial_code": "+504"},
  {"name": "Hong Kong", "flag": "ğŸ‡­ğŸ‡°", "code": "HK", "dial_code": "+852"},
  {"name": "Hungary", "flag": "ğŸ‡­ğŸ‡º", "code": "HU", "dial_code": "+36"},
  {"name": "Iceland", "flag": "ğŸ‡®ğŸ‡¸", "code": "IS", "dial_code": "+354"},
  {"name": "India", "flag": "ğŸ‡®ğŸ‡³", "code": "IN", "dial_code": "+91"},
  {"name": "Indonesia", "flag": "ğŸ‡®ğŸ‡©", "code": "ID", "dial_code": "+62"},
  {"name": "Iran, Islamic Republic of", "flag": "ğŸ‡®ğŸ‡·", "code": "IR", "dial_code": "+98"},
  {"name": "Iraq", "flag": "ğŸ‡®ğŸ‡¶", "code": "IQ", "dial_code": "+964"},
  {"name": "Ireland", "flag": "ğŸ‡®ğŸ‡ª", "code": "IE", "dial_code": "+353"},
  {"name": "Isle of Man", "flag": "ğŸ‡®ğŸ‡²", "code": "IM", "dial_code": "+44"},
  {"name": "Israel", "flag": "ğŸ‡®ğŸ‡±", "code": "IL", "dial_code": "+972"},
  {"name": "Italy", "flag": "ğŸ‡®ğŸ‡¹", "code": "IT", "dial_code": "+39"},
  {"name": "Jamaica", "flag": "ğŸ‡¯ğŸ‡²", "code": "JM", "dial_code": "+1876"},
  {"name": "Japan", "flag": "ğŸ‡¯ğŸ‡µ", "code": "JP", "dial_code": "+81"},
  {"name": "Jersey", "flag": "ğŸ‡¯ğŸ‡ª", "code": "JE", "dial_code": "+44"},
  {"name": "Jordan", "flag": "ğŸ‡¯ğŸ‡´", "code": "JO", "dial_code": "+962"},
  {"name": "Kazakhstan", "flag": "ğŸ‡°ğŸ‡¿", "code": "KZ", "dial_code": "+7"},
  {"name": "Kenya", "flag": "ğŸ‡°ğŸ‡ª", "code": "KE", "dial_code": "+254"},
  {"name": "Kiribati", "flag": "ğŸ‡°ğŸ‡®", "code": "KI", "dial_code": "+686"},
  {"name": "Korea, Democratic People's Republic of", "flag": "ğŸ‡°ğŸ‡µ", "code": "KP", "dial_code": "+850"},
  {"name": "Korea, Republic of", "flag": "ğŸ‡°ğŸ‡·", "code": "KR", "dial_code": "+82"},
  {"name": "Kuwait", "flag": "ğŸ‡°ğŸ‡¼", "code": "KW", "dial_code": "+965"},
  {"name": "Kyrgyzstan", "flag": "ğŸ‡°ğŸ‡¬", "code": "KG", "dial_code": "+996"},
  {"name": "Lao People's Democratic Republic", "flag": "ğŸ‡±ğŸ‡¦", "code": "LA", "dial_code": "+856"},
  {"name": "Latvia", "flag": "ğŸ‡±ğŸ‡»", "code": "LV", "dial_code": "+371"},
  {"name": "Lebanon", "flag": "ğŸ‡±ğŸ‡§", "code": "LB", "dial_code": "+961"},
  {"name": "Lesotho", "flag": "ğŸ‡±ğŸ‡¸", "code": "LS", "dial_code": "+266"},
  {"name": "Liberia", "flag": "ğŸ‡±ğŸ‡·", "code": "LR", "dial_code": "+231"},
  {"name": "Libyan Arab Jamahiriya", "flag": "ğŸ‡±ğŸ‡¾", "code": "LY", "dial_code": "+218"},
  {"name": "Liechtenstein", "flag": "ğŸ‡±ğŸ‡®", "code": "LI", "dial_code": "+423"},
  {"name": "Lithuania", "flag": "ğŸ‡±ğŸ‡¹", "code": "LT", "dial_code": "+370"},
  {"name": "Luxembourg", "flag": "ğŸ‡±ğŸ‡º", "code": "LU", "dial_code": "+352"},
  {"name": "Macao", "flag": "ğŸ‡²ğŸ‡´", "code": "MO", "dial_code": "+853"},
  {"name": "Macedonia, The Former Yugoslav Republic of", "flag": "ğŸ‡²ğŸ‡°", "code": "MK", "dial_code": "+389"},
  {"name": "Madagascar", "flag": "ğŸ‡²ğŸ‡¬", "code": "MG", "dial_code": "+261"},
  {"name": "Malawi", "flag": "ğŸ‡²ğŸ‡¼", "code": "MW", "dial_code": "+265"},
  {"name": "Malaysia", "flag": "ğŸ‡²ğŸ‡¾", "code": "MY", "dial_code": "+60"},
  {"name": "Maldives", "flag": "ğŸ‡²ğŸ‡»", "code": "MV", "dial_code": "+960"},
  {"name": "Mali", "flag": "ğŸ‡²ğŸ‡±", "code": "ML", "dial_code": "+223"},
  {"name": "Malta", "flag": "ğŸ‡²ğŸ‡¹", "code": "MT", "dial_code": "+356"},
  {"name": "Marshall Islands", "flag": "ğŸ‡²ğŸ‡­", "code": "MH", "dial_code": "+692"},
  {"name": "Martinique", "flag": "ğŸ‡²ğŸ‡¶", "code": "MQ", "dial_code": "+596"},
  {"name": "Mauritania", "flag": "ğŸ‡²ğŸ‡·", "code": "MR", "dial_code": "+222"},
  {"name": "Mauritius", "flag": "ğŸ‡²ğŸ‡º", "code": "MU", "dial_code": "+230"},
  {"name": "Mayotte", "flag": "ğŸ‡¾ğŸ‡¹", "code": "YT", "dial_code": "+262"},
  {"name": "Mexico", "flag": "ğŸ‡²ğŸ‡½", "code": "MX", "dial_code": "+52"},
  {"name": "Micronesia, Federated States of", "flag": "ğŸ‡«ğŸ‡²", "code": "FM", "dial_code": "+691"},
  {"name": "Moldova, Republic of", "flag": "ğŸ‡²ğŸ‡©", "code": "MD", "dial_code": "+373"},
  {"name": "Monaco", "flag": "ğŸ‡²ğŸ‡¨", "code": "MC", "dial_code": "+377"},
  {"name": "Mongolia", "flag": "ğŸ‡²ğŸ‡³", "code": "MN", "dial_code": "+976"},
  {"name": "Montenegro", "flag": "ğŸ‡²ğŸ‡ª", "code": "ME", "dial_code": "+382"},
  {"name": "Montserrat", "flag": "ğŸ‡²ğŸ‡¸", "code": "MS", "dial_code": "+1664"},
  {"name": "Morocco", "flag": "ğŸ‡²ğŸ‡¦", "code": "MA", "dial_code": "+212"},
  {"name": "Mozambique", "flag": "ğŸ‡²ğŸ‡¿", "code": "MZ", "dial_code": "+258"},
  {"name": "Myanmar", "flag": "ğŸ‡²ğŸ‡²", "code": "MM", "dial_code": "+95"},
  {"name": "Namibia", "flag": "ğŸ‡³ğŸ‡¦", "code": "NA", "dial_code": "+264"},
  {"name": "Nauru", "flag": "ğŸ‡³ğŸ‡·", "code": "NR", "dial_code": "+674"},
  {"name": "Nepal", "flag": "ğŸ‡³ğŸ‡µ", "code": "NP", "dial_code": "+977"},
  {"name": "Netherlands", "flag": "ğŸ‡³ğŸ‡±", "code": "NL", "dial_code": "+31"},
  {"name": "New Caledonia", "flag": "ğŸ‡³ğŸ‡¨", "code": "NC", "dial_code": "+687"},
  {"name": "New Zealand", "flag": "ğŸ‡³ğŸ‡¿", "code": "NZ", "dial_code": "+64"},
  {"name": "Nicaragua", "flag": "ğŸ‡³ğŸ‡®", "code": "NI", "dial_code": "+505"},
  {"name": "Niger", "flag": "ğŸ‡³ğŸ‡ª", "code": "NE", "dial_code": "+227"},
  {"name": "Nigeria", "flag": "ğŸ‡³ğŸ‡¬", "code": "NG", "dial_code": "+234"},
  {"name": "Niue", "flag": "ğŸ‡³ğŸ‡º", "code": "NU", "dial_code": "+683"},
  {"name": "Norfolk Island", "flag": "ğŸ‡³ğŸ‡«", "code": "NF", "dial_code": "+672"},
  {"name": "Northern Mariana Islands", "flag": "ğŸ‡²ğŸ‡µ", "code": "MP", "dial_code": "+1670"},
  {"name": "Norway", "flag": "ğŸ‡³ğŸ‡´", "code": "NO", "dial_code": "+47"},
  {"name": "Oman", "flag": "ğŸ‡´ğŸ‡²", "code": "OM", "dial_code": "+968"},
  {"name": "Pakistan", "flag": "ğŸ‡µğŸ‡°", "code": "PK", "dial_code": "+92"},
  {"name": "Palau", "flag": "ğŸ‡µğŸ‡¼", "code": "PW", "dial_code": "+680"},
  {"name": "Palestinian Territory, Occupied", "flag": "ğŸ‡µğŸ‡¸", "code": "PS", "dial_code": "+970"},
  {"name": "Panama", "flag": "ğŸ‡µğŸ‡¦", "code": "PA", "dial_code": "+507"},
  {"name": "Papua New Guinea", "flag": "ğŸ‡µğŸ‡¬", "code": "PG", "dial_code": "+675"},
  {"name": "Paraguay", "flag": "ğŸ‡µğŸ‡¾", "code": "PY", "dial_code": "+595"},
  {"name": "Peru", "flag": "ğŸ‡µğŸ‡ª", "code": "PE", "dial_code": "+51"},
  {"name": "Philippines", "flag": "ğŸ‡µğŸ‡­", "code": "PH", "dial_code": "+63"},
  {"name": "Pitcairn", "flag": "ğŸ‡µğŸ‡³", "code": "PN", "dial_code": "+872"},
  {"name": "Poland", "flag": "ğŸ‡µğŸ‡±", "code": "PL", "dial_code": "+48"},
  {"name": "Portugal", "flag": "ğŸ‡µğŸ‡¹", "code": "PT", "dial_code": "+351"},
  {"name": "Puerto Rico", "flag": "ğŸ‡µğŸ‡·", "code": "PR", "dial_code": "+1939"},
  {"name": "Qatar", "flag": "ğŸ‡¶ğŸ‡¦", "code": "QA", "dial_code": "+974"},
  {"name": "RÃ©union", "flag": "ğŸ‡·ğŸ‡ª", "code": "RE", "dial_code": "+262"},
  {"name": "Romania", "flag": "ğŸ‡·ğŸ‡´", "code": "RO", "dial_code": "+40"},
  {"name": "Russian Federation", "flag": "ğŸ‡·ğŸ‡º", "code": "RU", "dial_code": "+7"},
  {"name": "Rwanda", "flag": "ğŸ‡·ğŸ‡¼", "code": "RW", "dial_code": "+250"},
  {"name": "Saint BarthÃ©lemy", "flag": "ğŸ‡§ğŸ‡±", "code": "BL", "dial_code": "+590"},
  {"name": "Saint Helena, Ascension and Tristan Da Cunha", "flag": "ğŸ‡¸ğŸ‡­", "code": "SH", "dial_code": "+290"},
  {"name": "Saint Kitts and Nevis", "flag": "ğŸ‡°ğŸ‡³", "code": "KN", "dial_code": "+1869"},
  {"name": "Saint Lucia", "flag": "ğŸ‡±ğŸ‡¨", "code": "LC", "dial_code": "+1758"},
  {"name": "Saint Martin (French Part)", "flag": "ğŸ‡²ğŸ‡«", "code": "MF", "dial_code": "+590"},
  {"name": "Saint Pierre and Miquelon", "flag": "ğŸ‡µğŸ‡²", "code": "PM", "dial_code": "+508"},
  {"name": "Saint Vincent and the Grenadines", "flag": "ğŸ‡»ğŸ‡¨", "code": "VC", "dial_code": "+1784"},
  {"name": "Samoa", "flag": "ğŸ‡¼ğŸ‡¸", "code": "WS", "dial_code": "+685"},
  {"name": "San Marino", "flag": "ğŸ‡¸ğŸ‡²", "code": "SM", "dial_code": "+378"},
  {"name": "Sao Tome and Principe", "flag": "ğŸ‡¸ğŸ‡¹", "code": "ST", "dial_code": "+239"},
  {"name": "Saudi Arabia", "flag": "ğŸ‡¸ğŸ‡¦", "code": "SA", "dial_code": "+966"},
  {"name": "Senegal", "flag": "ğŸ‡¸ğŸ‡³", "code": "SN", "dial_code": "+221"},
  {"name": "Serbia", "flag": "ğŸ‡·ğŸ‡¸", "code": "RS", "dial_code": "+381"},
  {"name": "Seychelles", "flag": "ğŸ‡¸ğŸ‡¨", "code": "SC", "dial_code": "+248"},
  {"name": "Sierra Leone", "flag": "ğŸ‡¸ğŸ‡±", "code": "SL", "dial_code": "+232"},
  {"name": "Singapore", "flag": "ğŸ‡¸ğŸ‡¬", "code": "SG", "dial_code": "+65"},
  {"name": "Sint Maarten (Dutch Part)", "flag": "ğŸ‡¸ğŸ‡½", "code": "SX", "dial_code": "+1721"},
  {"name": "Slovakia", "flag": "ğŸ‡¸ğŸ‡°", "code": "SK", "dial_code": "+421"},
  {"name": "Slovenia", "flag": "ğŸ‡¸ğŸ‡®", "code": "SI", "dial_code": "+386"},
  {"name": "Solomon Islands", "flag": "ğŸ‡¸ğŸ‡§", "code": "SB", "dial_code": "+677"},
  {"name": "Somalia", "flag": "ğŸ‡¸ğŸ‡´", "code": "SO", "dial_code": "+252"},
  {"name": "South Africa", "flag": "ğŸ‡¿ğŸ‡¦", "code": "ZA", "dial_code": "+27"},
  {"name": "South Georgia and the South Sandwich Islands", "flag": "ğŸ‡¬ğŸ‡¸", "code": "GS", "dial_code": "+500"},
  {"name": "Spain", "flag": "ğŸ‡ªğŸ‡¸", "code": "ES", "dial_code": "+34"},
  {"name": "Sri Lanka", "flag": "ğŸ‡±ğŸ‡°", "code": "LK", "dial_code": "+94"},
  {"name": "Sudan", "flag": "ğŸ‡¸ğŸ‡©", "code": "SD", "dial_code": "+249"},
  {"name": "Suriname", "flag": "ğŸ‡¸ğŸ‡·", "code": "SR", "dial_code": "+597"},
  {"name": "Svalbard and Jan Mayen", "flag": "ğŸ‡¸ğŸ‡¯", "code": "SJ", "dial_code": "+47"},
  {"name": "Swaziland", "flag": "ğŸ‡¸ğŸ‡¿", "code": "SZ", "dial_code": "+268"},
  {"name": "Sweden", "flag": "ğŸ‡¸ğŸ‡ª", "code": "SE", "dial_code": "+46"},
  {"name": "Switzerland", "flag": "ğŸ‡¨ğŸ‡­", "code": "CH", "dial_code": "+41"},
  {"name": "Syrian Arab Republic", "flag": "ğŸ‡¸ğŸ‡¾", "code": "SY", "dial_code": "+963"},
  {"name": "Taiwan, Province of China", "flag": "ğŸ‡¹ğŸ‡¼", "code": "TW", "dial_code": "+886"},
  {"name": "Tajikistan", "flag": "ğŸ‡¹ğŸ‡¯", "code": "TJ", "dial_code": "+992"},
  {"name": "Tanzania, United Republic of", "flag": "ğŸ‡¹ğŸ‡¿", "code": "TZ", "dial_code": "+255"},
  {"name": "Thailand", "flag": "ğŸ‡¹ğŸ‡­", "code": "TH", "dial_code": "+66"},
  {"name": "Timor-Leste", "flag": "ğŸ‡¹ğŸ‡±", "code": "TL", "dial_code": "+670"},
  {"name": "Togo", "flag": "ğŸ‡¹ğŸ‡¬", "code": "TG", "dial_code": "+228"},
  {"name": "Tokelau", "flag": "ğŸ‡¹ğŸ‡°", "code": "TK", "dial_code": "+690"},
  {"name": "Tonga", "flag": "ğŸ‡¹ğŸ‡´", "code": "TO", "dial_code": "+676"},
  {"name": "Trinidad and Tobago", "flag": "ğŸ‡¹ğŸ‡¹", "code": "TT", "dial_code": "+1868"},
  {"name": "Tunisia", "flag": "ğŸ‡¹ğŸ‡³", "code": "TN", "dial_code": "+216"},
  {"name": "Turkey", "flag": "ğŸ‡¹ğŸ‡·", "code": "TR", "dial_code": "+90"},
  {"name": "Turkmenistan", "flag": "ğŸ‡¹ğŸ‡²", "code": "TM", "dial_code": "+993"},
  {"name": "Turks and Caicos Islands", "flag": "ğŸ‡¹ğŸ‡¨", "code": "TC", "dial_code": "+1649"},
  {"name": "Tuvalu", "flag": "ğŸ‡¹ğŸ‡»", "code": "TV", "dial_code": "+688"},
  {"name": "Uganda", "flag": "ğŸ‡ºğŸ‡¬", "code": "UG", "dial_code": "+256"},
  {"name": "Ukraine", "flag": "ğŸ‡ºğŸ‡¦", "code": "UA", "dial_code": "+380"},
  {"name": "United Arab Emirates", "flag": "ğŸ‡¦ğŸ‡ª", "code": "AE", "dial_code": "+971"},
  {"name": "United Kingdom", "flag": "ğŸ‡¬ğŸ‡§", "code": "GB", "dial_code": "+44"},
  {"name": "United States", "flag": "ğŸ‡ºğŸ‡¸", "code": "US", "dial_code": "+1"},
  {"name": "Uruguay", "flag": "ğŸ‡ºğŸ‡¾", "code": "UY", "dial_code": "+598"},
  {"name": "Uzbekistan", "flag": "ğŸ‡ºğŸ‡¿", "code": "UZ", "dial_code": "+998"},
  {"name": "Vanuatu", "flag": "ğŸ‡»ğŸ‡º", "code": "VU", "dial_code": "+678"},
  {"name": "Venezuela, Bolivarian Republic of", "flag": "ğŸ‡»ğŸ‡ª", "code": "VE", "dial_code": "+58"},
  {"name": "Viet Nam", "flag": "ğŸ‡»ğŸ‡³", "code": "VN", "dial_code": "+84"},
  {"name": "Virgin Islands, British", "flag": "ğŸ‡»ğŸ‡¬", "code": "VG", "dial_code": "+1284"},
  {"name": "Virgin Islands, U.S.", "flag": "ğŸ‡»ğŸ‡®", "code": "VI", "dial_code": "+1340"},
  {"name": "Wallis and Futuna", "flag": "ğŸ‡¼ğŸ‡«", "code": "WF", "dial_code": "+681"},
  {"name": "Yemen", "flag": "ğŸ‡¾ğŸ‡ª", "code": "YE", "dial_code": "+967"},
  {"name": "Zambia", "flag": "ğŸ‡¿ğŸ‡²", "code": "ZM", "dial_code": "+260"},
  {"name": "Zimbabwe", "flag": "ğŸ‡¿ğŸ‡¼", "code": "ZW", "dial_code": "+263"}
]

def verify_number_country(number: str, expected_country: str) -> bool:
    """
    Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø±Ù‚Ù… ÙŠÙ†ØªÙ…ÙŠ Ù„Ù„Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ø¶Ø¨ÙˆØ·
    """
    try:
        # Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
        country_data = None
        for country in COUNTRIES_DATA:
            if country["name"].lower().replace(" ", "_") == expected_country.lower():
                country_data = country
                break
        
        if not country_data:
            print(f"âŒ Ø§Ù„Ø¯ÙˆÙ„Ø© {expected_country} ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©")
            return False
        
        country_code = country_data["code"]
        country_dial_code = country_data["dial_code"].replace('+', '')
        
        print(f"ğŸ” ÙØ­Øµ Ø§Ù„Ø±Ù‚Ù…: {number} Ù„Ù„Ø¯ÙˆÙ„Ø©: {expected_country}")
        print(f"   ÙƒÙˆØ¯ Ø§Ù„Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹: {country_code}")
        print(f"   ÙƒÙˆØ¯ Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹: +{country_dial_code}")
        
        # Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 1: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙˆØ¯ Ø§Ù„Ø§ØªØµØ§Ù„ (Ø§Ù„Ø£Ø³Ù‡Ù„)
        if number.startswith(country_dial_code):
            print(f"âœ… Ø§Ù„Ø±Ù‚Ù… {number} ÙŠØ¨Ø¯Ø£ Ø¨ÙƒÙˆØ¯ Ø§Ù„Ø¯ÙˆÙ„Ø© +{country_dial_code}")
            return True
        
        # Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 2: Ø§Ø³ØªØ®Ø¯Ø§Ù… phonenumbers Ù„Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø¯Ù‚ÙŠÙ‚
        try:
            parsed_number = phonenumbers.parse(f"+{number}", None)
            actual_country = phonenumbers.region_code_for_number(parsed_number)
            
            if actual_country == country_code:
                print(f"âœ… Ø§Ù„Ø±Ù‚Ù… {number} Ù…Ù† Ø§Ù„Ø¯ÙˆÙ„Ø© {actual_country}")
                return True
            else:
                print(f"âŒ Ø§Ù„Ø±Ù‚Ù… {number} Ù…Ù† {actual_country} ÙˆÙ„ÙŠØ³ Ù…Ù† {country_code}")
                return False
                
        except Exception as e:
            print(f"âš ï¸ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø±Ù‚Ù…: {e}")
            # Ù†Ø¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ ÙÙ‚Ø·
            return number.startswith(country_dial_code)
            
    except Exception as e:
        print(f"ğŸš¨ Ø®Ø·Ø£ Ø¹Ø§Ù… ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚: {e}")
        return False
# ============= Helper Functions =============
def get_number_status(messages: List[Dict[str, str]]) -> str:
    """
    Function to determine number status based on last message time

    Parameters:
        messages (List[Dict[str, str]]): List of messages from inbox

    Returns:
        str: Status string with emoji
    """
    if not messages:
        return "â›” ØºÙŠØ± Ù†Ø´Ø· (Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø³Ø§Ø¦Ù„)"

    # Get the first message (most recent)
    latest_message = messages[0]
    latest_time_str = list(latest_message.keys())[0]

    # Check for different time patterns
    if "Ø«Ø§Ù†ÙŠØ©" in latest_time_str or "second" in latest_time_str.lower():
        return "ğŸŸ¢ Ù†Ø´Ø· (Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© Ù…Ù†Ø° Ø«ÙˆØ§Ù†Ù)"
    elif "Ø¯Ù‚ÙŠÙ‚Ø©" in latest_time_str or "minute" in latest_time_str.lower():
        return "ğŸŸ¢ Ù†Ø´Ø· (Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© Ù…Ù†Ø° Ø¯Ù‚Ø§Ø¦Ù‚)"
    elif "Ø³Ø§Ø¹Ø©" in latest_time_str or "hour" in latest_time_str.lower():
        return "ğŸŸ¢ Ù†Ø´Ø· (Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© Ù…Ù†Ø° Ø³Ø§Ø¹Ø§Øª)"
    elif "ÙŠÙˆÙ…" in latest_time_str or "day" in latest_time_str.lower():
        return "â›” ØºÙŠØ± Ù…Ø³ØªÙ‚Ø± (Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© Ù…Ù†Ø° Ø£ÙŠØ§Ù…)"
    elif "Ø´Ù‡Ø±" in latest_time_str or "month" in latest_time_str.lower():
        return "â›” ØºÙŠØ± Ù†Ø´Ø· (Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© Ù…Ù†Ø° Ø´Ù‡ÙˆØ±)"
    elif "Ø³Ù†Ø©" in latest_time_str or "year" in latest_time_str.lower():
        return "â›” ØºÙŠØ± Ù†Ø´Ø· (Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© Ù…Ù†Ø° Ø³Ù†ÙˆØ§Øª)"
    else:
        # Try to parse numbers for more precise checking
        numbers = re.findall(r'\d+', latest_time_str)
        if numbers:
            num = int(numbers[0])
            if "Ø«Ø§Ù†ÙŠØ©" in latest_time_str or "second" in latest_time_str.lower():
                return "ğŸŸ¢ Ù†Ø´Ø· (Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© Ù…Ù†Ø° Ø«ÙˆØ§Ù†Ù)"
            elif "Ø¯Ù‚ÙŠÙ‚Ø©" in latest_time_str or "minute" in latest_time_str.lower():
                return "ğŸŸ¢ Ù†Ø´Ø· (Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© Ù…Ù†Ø° Ø¯Ù‚Ø§Ø¦Ù‚)"
            elif "Ø³Ø§Ø¹Ø©" in latest_time_str or "hour" in latest_time_str.lower():
                if num <= 24:
                    return "ğŸŸ¢ Ù†Ø´Ø· (Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© Ù…Ù†Ø° Ø³Ø§Ø¹Ø§Øª)"
                else:
                    return "â›” ØºÙŠØ± Ù…Ø³ØªÙ‚Ø±"

        return "â›” ØºÙŠØ± Ù…Ø³ØªÙ‚Ø± (ÙˆÙ‚Øª ØºÙŠØ± Ù…Ø­Ø¯Ø¯)"


# ============= Bot Initialization =============
# Initialize the bot token
BOT_TOKEN = '8751316547:AAGrN48k5WIxd8Lhn_0-7XDKr5VCHVEKdJ0'
ADMIN_IDS = [8590809949]  # Developer IDs

bot: ClassVar[Any] = telebot.TeleBot(BOT_TOKEN)
print(f"\33[1;36m::\33[m Bot is running with ID: {bot.get_me().id}")
print(f"\33[1;36m::\33[m Admin IDs: {', '.join(ADMIN_IDS)}")

# Bot settings storage
bot_settings = {
    'bot_enabled': True,
    'activation_channel': None,
    'forced_channel': None,
    'stats': {
        'total_users': 0,
        'total_numbers': 0
    }
}
# ============= Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† =============
user_database = {
    'user_ids': set(),  # ØªØ®Ø²ÙŠÙ† Ø£ÙŠ Ø¯ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
    'user_data': {}     # ØªØ®Ø²ÙŠÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
}

# ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙÙŠ bot_settings
bot_settings['stats']['total_users'] = 0
bot_settings['stats']['total_numbers'] = 0
# Helper function to check if user is admin
def is_admin(user_id: int) -> bool:
    """Check if user is admin"""
    return str(user_id) in ADMIN_IDS

# Helper function to check forced subscription
def check_subscription(user_id: int) -> bool:
    """Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø© - Ù…Ø¶Ø¨ÙˆØ·"""
    if not bot_settings['forced_channel']:
        return True

    try:
        member = bot.get_chat_member(bot_settings['forced_channel'], user_id)
        return member.status in ['member', 'administrator', 'creator']
    except Exception as e:
        print(f"Error checking subscription: {e}")
        return False

@bot.callback_query_handler(func=lambda x: x.data == "check_subscription")
def check_subscription_handler(call: ClassVar[Any]) -> NoReturn:
    """Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ - Ù…Ø¶Ø¨ÙˆØ·"""
    if check_subscription(call.from_user.id):
        bot.answer_callback_query(call.id, "âœ… ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ø¢Ù†", show_alert=True)
        
        # Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø¯Ù„ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
        user = User(call.from_user)
        markup = telebot.types.InlineKeyboardMarkup()
        markup.row(
            telebot.types.InlineKeyboardButton(text="ğŸ”µ Ø§Ù„Ø³ÙŠØ±ÙØ± 1", callback_data="select_server_1"),
            telebot.types.InlineKeyboardButton(text="ğŸŸ¢ Ø§Ù„Ø³ÙŠØ±ÙØ± 2", callback_data="select_server_2")
        )
        markup.add(telebot.types.InlineKeyboardButton(text="ğŸŒ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯ÙˆÙ„", callback_data="show_countries"))

        bot.send_message(
            chat_id=call.message.chat.id,
            text=f"â€â´ Ù…Ø±Ø­Ø¨Ø§Ù‹ {user.pn}\nØ£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¨ÙˆØª Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ÙˆÙ‡Ù…ÙŠØ©\n\nØ§Ø®ØªØ± Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ùƒ ğŸ“±",
            reply_markup=markup
        )
    else:
        bot.answer_callback_query(call.id, "âŒ Ù„Ù… ØªØ´ØªØ±Ùƒ ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø© Ø¨Ø¹Ø¯!", show_alert=True)

# Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ø§ Ø§Ù„Ù‡Ø§Ù†Ø¯Ù„Ø± Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ START
@bot.message_handler(commands=["start", "restart"])
def start_command_handler(message: ClassVar[Any]) -> NoReturn:
    """Ø¨Ø¯Ø¡ Ø§Ù„Ø¨ÙˆØª Ù…Ø¹ Ø­ÙØ¸ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"""
    # Ø­ÙØ¸ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    user_id = message.from_user.id
    user_database['user_ids'].add(user_id)
    user_database['user_data'][user_id] = {
        'first_name': message.from_user.first_name,
        'username': message.from_user.username,
        'join_date': datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
        'last_activity': datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    }
    
    # ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
    bot_settings['stats']['total_users'] = len(user_database['user_ids'])
    """Ø¨Ø¯Ø¡ Ø§Ù„Ø¨ÙˆØª Ù…Ø¹ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ"""
    # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠ
    if bot_settings['forced_channel'] and not check_subscription(message.from_user.id):
        markup = telebot.types.InlineKeyboardMarkup()
        markup.add(telebot.types.InlineKeyboardButton(
            text="âœ… Ø§Ø´ØªØ±Ùƒ ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø©",
            url=f"https://t.me/{bot_settings['forced_channel'].replace('@', '')}"
        ))
        markup.add(telebot.types.InlineKeyboardButton(
            text="ğŸ”„ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ",
            callback_data="check_subscription"
        ))
        
        bot.reply_to(
            message,
            text=(
                "âš ï¸ ÙŠØ¬Ø¨ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø© Ø£ÙˆÙ„Ø§Ù‹\n\n"
                f"Ø§Ù„Ù‚Ù†Ø§Ø©: {bot_settings['forced_channel']}\n"
                "Ø§Ø´ØªØ±Ùƒ ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø© Ø«Ù… Ø§Ø¶ØºØ· 'ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ'"
            ),
            reply_markup=markup
        )
        return

    # Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø´ØªØ±ÙƒØŒ ØªØ¸Ù‡Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    user: ClassVar[Union[str, int]] = User(message.from_user)
    bot.send_chat_action(chat_id=message.chat.id, action="typing")

    markup = telebot.types.InlineKeyboardMarkup()
    markup.row(
        telebot.types.InlineKeyboardButton(text="ğŸ”µ Ø§Ù„Ø³ÙŠØ±ÙØ± 1", callback_data="select_server_1"),
        telebot.types.InlineKeyboardButton(text="ğŸŸ¢ Ø§Ù„Ø³ÙŠØ±ÙØ± 2", callback_data="select_server_2")
    )
    markup.add(telebot.types.InlineKeyboardButton(text="â“ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©", callback_data="show_help"))

    bot.reply_to(
        message=message,
        text=(
            f"â€â´ Ù…Ø±Ø­Ø¨Ø§Ù‹ {user.pn}\n"
            "Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¨ÙˆØª Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ÙˆÙ‡Ù…ÙŠØ© Ø§Ù„Ù…ØªØ·ÙˆØ±\n\n"
            "ğŸ”µ Ø³ÙŠØ±ÙØ± 1: OnlineSim - Ø£Ø±Ù‚Ø§Ù… Ù…ÙˆØ«ÙˆÙ‚Ø©\n"
            "ğŸŸ¢ Ø³ÙŠØ±ÙØ± 2: FreeSMS - Ø£Ø±Ù‚Ø§Ù… Ù…Ø¬Ø§Ù†ÙŠØ©\n\n"
            "Ø§Ø®ØªØ± Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ùƒ ğŸ“±"
        ),
        reply_markup=markup
    )

# ============= Bot Command Handlers =============
@bot.message_handler(commands=["admin", "panel"])
def admin_panel_handler(message: ClassVar[Any]) -> NoReturn:
    """Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù† - ÙƒÙ„ Ø²Ø± ÙÙŠÙ‡ Ø±Ø¬ÙˆØ¹"""
    user_id = message.from_user.id
    
    if not is_admin(user_id):
        bot.reply_to(message, "âŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù„ÙˆØ­Ø©")
        return

    markup = telebot.types.InlineKeyboardMarkup()

    # Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙˆØª
    markup.row(
        telebot.types.InlineKeyboardButton(
            text=f"ğŸ¤– Ø§Ù„Ø¨ÙˆØª: {'ğŸŸ¢ Ù…ÙÙØ¹Ù‘Ù„' if bot_settings['bot_enabled'] else 'ğŸ”´ Ù…ÙØ¹Ø·Ù‘Ù„'}",
            callback_data="admin_toggle_bot"
        )
    )

    # Ù‚Ù†ÙˆØ§Øª
    markup.row(
        telebot.types.InlineKeyboardButton(
            text="ğŸ“¢ Ù‚Ù†Ø§Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„Ø§Øª",
            callback_data="admin_set_activation"
        ),
        telebot.types.InlineKeyboardButton(
            text="ğŸ”’ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠ", 
            callback_data="admin_set_forced"
        )
    )

    # Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆØ¨Ø«
    markup.row(
        telebot.types.InlineKeyboardButton(
            text="ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª",
            callback_data="admin_stats"
        ),
        telebot.types.InlineKeyboardButton(
            text="ğŸ“£ Ø¨Ø« Ø¬Ù…Ø§Ø¹ÙŠ",
            callback_data="admin_broadcast"
        )
    )

    # Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ†
    markup.row(
        telebot.types.InlineKeyboardButton(
            text="ğŸ‘¥ Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ†",
            callback_data="admin_devs"
        )
    )

    bot.reply_to(
        message,
        text=(
            "ğŸ› **Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ†**\n\n"
            f"ğŸ‘¤ Ø§Ù„Ù…Ø·ÙˆØ±: {message.from_user.first_name}\n"
            f"ğŸ†” Ø§Ù„Ø£ÙŠØ¯ÙŠ: `{message.from_user.id}`\n\n"
            "Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:"
        ),
        reply_markup=markup,
        parse_mode='Markdown'
    )

@bot.callback_query_handler(func=lambda x: x.data == "admin_stats")
def admin_stats_handler(call: ClassVar[Any]) -> NoReturn:
    """Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù…Ø¹ Ø²Ø± Ø±Ø¬ÙˆØ¹"""
    if not is_admin(call.from_user.id):
        bot.answer_callback_query(call.id, "âŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ©", show_alert=True)
        return

    markup = telebot.types.InlineKeyboardMarkup()
    markup.row(
        telebot.types.InlineKeyboardButton(
            text="ğŸ”„ ØªØ­Ø¯ÙŠØ«",
            callback_data="admin_stats"
        ),
        telebot.types.InlineKeyboardButton(
            text="ğŸ”™ Ø±Ø¬ÙˆØ¹", 
            callback_data="back_to_admin"
        )
    )

    bot.edit_message_text(
        chat_id=call.message.chat.id,
        message_id=call.message.message_id,
        text=(
            "ğŸ“Š **Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¨ÙˆØª**\n\n"
            f"ğŸ‘¥ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†: `{bot_settings['stats']['total_users']}`\n"
            f"ğŸ“± Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©: `{bot_settings['stats']['total_numbers']}`\n"
            f"ğŸ¤– Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙˆØª: `{'Ù…ÙØ¹Ù„' if bot_settings['bot_enabled'] else 'Ù…Ø¹Ø·Ù„'}`\n"
            f"ğŸ“¢ Ù‚Ù†Ø§Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„Ø§Øª: `{bot_settings['activation_channel'] or 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}`\n"
            f"ğŸ”’ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠ: `{bot_settings['forced_channel'] or 'ØºÙŠØ± Ù…ÙØ¹Ù„'}`\n"
            f"ğŸ‘¤ Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ†: `{len(ADMIN_IDS)}`"
        ),
        reply_markup=markup,
        parse_mode='Markdown'
    )

@bot.callback_query_handler(func=lambda x: x.data == "admin_devs")
def admin_devs_handler(call: ClassVar[Any]) -> NoReturn:
    """Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ† Ù…Ø¹ Ø²Ø± Ø±Ø¬ÙˆØ¹"""
    if not is_admin(call.from_user.id):
        bot.answer_callback_query(call.id, "âŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ©", show_alert=True)
        return

    markup = telebot.types.InlineKeyboardMarkup()
    markup.row(
        telebot.types.InlineKeyboardButton(
            text="ğŸ”™ Ø±Ø¬ÙˆØ¹",
            callback_data="back_to_admin"
        )
    )

    devs_text = "ğŸ‘¥ **Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ†:**\n\n"
    for i, dev_id in enumerate(ADMIN_IDS, 1):
        devs_text += f"{i}. `{dev_id}`\n"

    bot.edit_message_text(
        chat_id=call.message.chat.id,
        message_id=call.message.message_id,
        text=devs_text,
        reply_markup=markup,
        parse_mode='Markdown'
    )

@bot.callback_query_handler(func=lambda x: x.data == "admin_broadcast")
def admin_broadcast_handler(call: ClassVar[Any]) -> NoReturn:
    """Ø§Ù„Ø¨Ø« Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ Ù…Ø¹ Ø²Ø± Ø±Ø¬ÙˆØ¹"""
    if not is_admin(call.from_user.id):
        bot.answer_callback_query(call.id, "âŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ©", show_alert=True)
        return

    markup = telebot.types.InlineKeyboardMarkup()
    markup.add(telebot.types.InlineKeyboardButton(
        text="ğŸ”™ Ø±Ø¬ÙˆØ¹",
        callback_data="back_to_admin"
    ))

    bot.edit_message_text(
        chat_id=call.message.chat.id,
        message_id=call.message.message_id,
        text=(
            "ğŸ“£ **Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨Ø« Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ**\n\n"
            f"ğŸ‘¥ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†: {len(user_database['user_ids'])}\n\n"
            "Ù„Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø¬Ù…Ø§Ø¹ÙŠØ©:\n"
            "1. Ø§Ø¶ØºØ· /broadcast\n"
            "2. Ø£Ø±Ø³Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©\n"
            "3. Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„Ù‡Ø§ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†\n\n"
            "âš ï¸ ØªØ£ÙƒØ¯ Ù…Ù† ØµÙŠØ§ØºØ© Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ø´ÙƒÙ„ Ù…Ù†Ø§Ø³Ø¨"
        ),
        reply_markup=markup,
        parse_mode='Markdown'
    )

# Ø£Ø¶Ù Ø£Ù…Ø± Ø§Ù„Ø¨Ø« Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ
@bot.message_handler(commands=["broadcast"])
def broadcast_command_handler(message: ClassVar[Any]) -> NoReturn:
    """Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¨Ø« Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ"""
    if not is_admin(message.from_user.id):
        bot.reply_to(message, "âŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø±")
        return

    if len(user_database['user_ids']) == 0:
        bot.reply_to(message, "âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª")
        return

    markup = telebot.types.InlineKeyboardMarkup()
    markup.add(telebot.types.InlineKeyboardButton(
        text="âŒ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¨Ø«",
        callback_data="cancel_broadcast"
    ))

    msg = bot.reply_to(
        message,
        f"ğŸ“£ **Ø¨Ø¯Ø¡ Ø§Ù„Ø¨Ø« Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ**\n\n"
        f"ğŸ‘¥ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†: {len(user_database['user_ids'])}\n\n"
        "Ø£Ø±Ø³Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ Ø¨Ø«Ù‡Ø§ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†:\n\n"
        "ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù…:\n"
        "â€¢ Ù†Øµ Ø¹Ø§Ø¯ÙŠ\n" 
        "â€¢ Ù†Øµ Ù…Ø¹ Markdown\n"
        "â€¢ ØµÙˆØ±Ø© Ù…Ø¹ ØªØ¹Ù„ÙŠÙ‚\n"
        "â€¢ Ù…Ù„Ù Ù…Ø¹ ØªØ¹Ù„ÙŠÙ‚\n\n"
        "Ø£Ùˆ Ø§Ø¶ØºØ· âŒ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¨Ø«",
        reply_markup=markup,
        parse_mode='Markdown'
    )
    
    bot.register_next_step_handler(msg, process_broadcast)

def process_broadcast(message):
    """Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ© - Ù…Ø¶Ø¨ÙˆØ·"""
    if not is_admin(message.from_user.id):
        bot.reply_to(message, "âŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ©")
        return

    # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ù„ØºØ§Ø¡
    if message.text and message.text in ['/cancel', 'Ø¥Ù„ØºØ§Ø¡', 'cancel', 'Ø§Ù„ØºØ§Ø¡']:
        bot.reply_to(message, "âŒ ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¨Ø« Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ")
        return

    bot.reply_to(message, "ğŸ“¤ Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†...")

    success_count = 0
    fail_count = 0
    total_users = len(user_database['user_ids'])

    # Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¬Ù…ÙŠØ¹
    for user_id in list(user_database['user_ids']):
        try:
            # Ø¥Ø±Ø³Ø§Ù„ Ù†ÙØ³ Ù†ÙˆØ¹ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
            if message.content_type == 'text':
                bot.send_message(
                    user_id,
                    f"ğŸ“¢ **Ø¥Ø´Ø¹Ø§Ø± Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:**\n\n{message.text}",
                    parse_mode='Markdown'
                )
            elif message.content_type == 'photo':
                bot.send_photo(
                    user_id,
                    message.photo[-1].file_id,
                    caption=f"ğŸ“¢ **Ø¥Ø´Ø¹Ø§Ø± Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:**\n\n{message.caption or ''}",
                    parse_mode='Markdown'
                )
            elif message.content_type == 'document':
                bot.send_document(
                    user_id,
                    message.document.file_id,
                    caption=f"ğŸ“¢ **Ø¥Ø´Ø¹Ø§Ø± Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:**\n\n{message.caption or ''}",
                    parse_mode='Markdown'
                )
            else:
                # Ø¥Ø°Ø§ ÙƒØ§Ù† Ù†ÙˆØ¹ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØŒ Ù†Ø±Ø³Ù„ Ù†Øµ ÙÙ‚Ø·
                bot.send_message(
                    user_id,
                    f"ğŸ“¢ **Ø¥Ø´Ø¹Ø§Ø± Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:**\n\n{message.text or 'Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©'}",
                    parse_mode='Markdown'
                )
            
            success_count += 1
            
            # ØªØ£Ø®ÙŠØ± Ø¨Ø³ÙŠØ· Ù„ØªØ¬Ù†Ø¨ Ø­Ø¸Ø± Ø§Ù„ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…
            import time
            time.sleep(0.1)
            
        except Exception as e:
            print(f"Failed to send to {user_id}: {e}")
            fail_count += 1

    # ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù†ØªØ§Ø¦Ø¬
    report_text = (
        f"ğŸ“Š **ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¨Ø« Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ**\n\n"
        f"âœ… ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­: {success_count}\n"
        f"âŒ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: {fail_count}\n"
        f"ğŸ‘¥ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: {total_users}\n"
        f"ğŸ“ˆ Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­: {((success_count/total_users)*100):.1f}%"
    )

    markup = telebot.types.InlineKeyboardMarkup()
    markup.add(telebot.types.InlineKeyboardButton(
        text="ğŸ”™ Ø±Ø¬ÙˆØ¹ Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†",
        callback_data="back_to_admin"
    ))

    bot.reply_to(
        message,
        report_text,
        reply_markup=markup,
        parse_mode='Markdown'
    )

# Ø£Ø¶Ù Ø²Ø± Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¨Ø«
@bot.callback_query_handler(func=lambda x: x.data == "cancel_broadcast")
def cancel_broadcast_handler(call: ClassVar[Any]) -> NoReturn:
    """Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¨Ø« Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ"""
    if not is_admin(call.from_user.id):
        bot.answer_callback_query(call.id, "âŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ©", show_alert=True)
        return

    markup = telebot.types.InlineKeyboardMarkup()
    markup.add(telebot.types.InlineKeyboardButton(
        text="ğŸ”™ Ø±Ø¬ÙˆØ¹ Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†",
        callback_data="back_to_admin"
    ))

    bot.edit_message_text(
        chat_id=call.message.chat.id,
        message_id=call.message.message_id,
        text="âŒ ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¨Ø« Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ",
        reply_markup=markup
    )

@bot.callback_query_handler(func=lambda x: x.data == "back_to_admin")
def back_to_admin_handler(call: ClassVar[Any]) -> NoReturn:
    """Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"""
    if not is_admin(call.from_user.id):
        bot.answer_callback_query(call.id, "âŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ©", show_alert=True)
        return

    # Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ù†Ø´Ø§Ø¡ Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†
    markup = telebot.types.InlineKeyboardMarkup()

    # Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙˆØª
    markup.row(
        telebot.types.InlineKeyboardButton(
            text=f"ğŸ¤– Ø§Ù„Ø¨ÙˆØª: {'ğŸŸ¢ Ù…ÙÙØ¹Ù‘Ù„' if bot_settings['bot_enabled'] else 'ğŸ”´ Ù…ÙØ¹Ø·Ù‘Ù„'}",
            callback_data="admin_toggle_bot"
        )
    )

    # Ù‚Ù†ÙˆØ§Øª
    markup.row(
        telebot.types.InlineKeyboardButton(
            text="ğŸ“¢ Ù‚Ù†Ø§Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„Ø§Øª",
            callback_data="admin_set_activation"
        ),
        telebot.types.InlineKeyboardButton(
            text="ğŸ”’ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠ", 
            callback_data="admin_set_forced"
        )
    )

    # Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆØ¨Ø«
    markup.row(
        telebot.types.InlineKeyboardButton(
            text="ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª",
            callback_data="admin_stats"
        ),
        telebot.types.InlineKeyboardButton(
            text="ğŸ“£ Ø¨Ø« Ø¬Ù…Ø§Ø¹ÙŠ",
            callback_data="admin_broadcast"
        )
    )

    # Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ†
    markup.row(
        telebot.types.InlineKeyboardButton(
            text="ğŸ‘¥ Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ†",
            callback_data="admin_devs"
        )
    )

    bot.edit_message_text(
        chat_id=call.message.chat.id,
        message_id=call.message.message_id,
        text=(
            "ğŸ› **Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ†**\n\n"
            f"ğŸ‘¤ Ø§Ù„Ù…Ø·ÙˆØ±: {call.from_user.first_name}\n"
            f"ğŸ†” Ø§Ù„Ø£ÙŠØ¯ÙŠ: `{call.from_user.id}`\n\n"
            "Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:"
        ),
        reply_markup=markup,
        parse_mode='Markdown'
    )
    bot.answer_callback_query(call.id, "ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†")


@bot.message_handler(commands=["help", "usage"])
def help_command_handler(message: ClassVar[Any]) -> NoReturn:
    """
    Function to handle help commands in bot
    Shows help messages to users
    """
    user: ClassVar[Union[str, int]] = User(message.from_user)
    bot.send_chat_action(chat_id=message.chat.id, action="typing")

    markup = telebot.types.InlineKeyboardMarkup()
    markup.add(telebot.types.InlineKeyboardButton(
        text="ğŸŒ Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆÙ„Ø©",
        callback_data="show_countries"
    ))
    markup.add(telebot.types.InlineKeyboardButton(
        text="ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
        callback_data="main_menu"
    ))

    bot.reply_to(
        message=message,
        text=(
           "Â·á´¥Â· Ø¨ÙˆØª Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ÙˆÙ‡Ù…ÙŠØ©\n\n"
           "Ù‡Ø°Ø§ Ø§Ù„Ø¨ÙˆØª Ù…Ø­Ù…ÙŠ Ø¨Ø­Ù‚ÙˆÙ‚ velkor ÙˆÙŠØ¬Ù„Ø¨ "
           "Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù†Ø´Ø·Ø© ÙˆØ§Ù„Ù…ØªØ§Ø­Ø©.\n\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•\n"
           "â˜… Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆÙ„Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©\n\n"
           "â˜… Ø§Ø®ØªØ± Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…ØªØ§Ø­\n\n"
           "â˜… Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ù„Ø±Ø¤ÙŠØ© Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø©\n\n"
           "â˜… Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± (ÙØ­Øµ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ) Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù‚Ù…\n\n"
           "â˜… Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± (Ø±Ù‚Ù… Ø¬Ø¯ÙŠØ¯) Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø±Ù‚Ù… Ø¢Ø®Ø±\n"
           "â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n"
           "Ù‡Ø°Ø§ ÙƒÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬ Ù…Ø¹Ø±ÙØªÙ‡ Ø¹Ù† Ø§Ù„Ø¨ÙˆØª!"
        ),
        reply_markup=markup
    )


@bot.message_handler(commands=["country"])
def country_command_handler(message: ClassVar[Any]) -> NoReturn:
    """
    Function to handle country commands in bot
    Shows a list of countries with inline buttons
    """
    try:
        bot.send_chat_action(chat_id=message.chat.id, action="typing")
        loading_msg = bot.reply_to(message, "ğŸ” Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¯ÙˆÙ„ Ø§Ù„Ù…ØªØ§Ø­Ø© âŒ›...")

        def load_countries():
            try:
                send_country_list(message.chat.id, loading_msg.message_id, 0)
            except Exception as e:
                print(f"Error loading countries: {e}")
                bot.edit_message_text(
                    chat_id=message.chat.id,
                    message_id=loading_msg.message_id,
                    text="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯ÙˆÙ„. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰."
                )

        thread = threading.Thread(target=load_countries)
        thread.daemon = True
        thread.start()

    except Exception as e:
        print(f"Error in country_command_handler: {e}")
        bot.reply_to(message, "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯ÙˆÙ„. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.")


def send_country_list(chat_id: int, message_id: int, page: int = 0) -> NoReturn:
    """
    Function to send country list with pagination
    """
    try:
        items_per_page = 6
        start_index = page * items_per_page
        end_index = start_index + items_per_page

        engine: ClassVar[Any] = VNEngine()

        try:
            online_countries = engine.get_online_countries()
        except Exception as e:
            print(f"Error getting countries: {e}")
            text = "âŒ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰."
            if message_id:
                bot.edit_message_text(chat_id=chat_id, message_id=message_id, text=text)
            else:
                bot.send_message(chat_id=chat_id, text=text)
            return

        if not online_countries:
            text = "âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯ÙˆÙ„ Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹"
            if message_id:
                bot.edit_message_text(chat_id=chat_id, message_id=message_id, text=text)
            else:
                bot.send_message(chat_id=chat_id, text=text)
            return

        countries_to_display = online_countries[start_index:end_index]

        markup = telebot.types.InlineKeyboardMarkup()
        for country in countries_to_display:
            country_flag = "ğŸ³ï¸"
            for country_data in COUNTRIES_DATA:
                if country_data["name"].lower().replace(" ", "_") == country["name"].lower():
                    country_flag = country_data["flag"]
                    break

            markup.add(telebot.types.InlineKeyboardButton(
                text=f"{country_flag} {country['name'].replace('_', ' ').title()}",
                callback_data=f"country_select&{country['name']}"
            ))

        navigation_buttons = []
        if page > 0:
            navigation_buttons.append(telebot.types.InlineKeyboardButton(
                text="â—€ï¸ Ø§Ù„Ø³Ø§Ø¨Ù‚",
                callback_data=f"country_page&{page - 1}"
            ))
        if end_index < len(online_countries):
            navigation_buttons.append(telebot.types.InlineKeyboardButton(
                text="Ø§Ù„ØªØ§Ù„ÙŠ â–¶ï¸",
                callback_data=f"country_page&{page + 1}"
            ))

        if navigation_buttons:
            markup.row(*navigation_buttons)

        markup.add(telebot.types.InlineKeyboardButton(
            text="ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
            callback_data="main_menu"
        ))

        text = f"ğŸŒ Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆÙ„Ø©:\n\nØ§Ù„ØµÙØ­Ø© {page + 1} Ù…Ù† {(len(online_countries) - 1) // items_per_page + 1}\nØ§Ù„Ø¯ÙˆÙ„ Ø§Ù„Ù…ØªØ§Ø­Ø©: {len(online_countries)}"

        if message_id:
            bot.edit_message_text(
                chat_id=chat_id,
                message_id=message_id,
                text=text,
                reply_markup=markup
            )
        else:
            bot.send_message(
                chat_id=chat_id,
                text=text,
                reply_markup=markup
            )
    except Exception as e:
        print(f"Error in send_country_list: {e}")
        try:
            if message_id:
                bot.edit_message_text(
                    chat_id=chat_id,
                    message_id=message_id,
                    text="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯ÙˆÙ„"
                )
            else:
                bot.send_message(chat_id=chat_id, text="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯ÙˆÙ„")
        except:
            pass


@bot.callback_query_handler(func=lambda x: x.data == "check_subscription")
def check_subscription_handler(call: ClassVar[Any]) -> NoReturn:
    """Check subscription callback"""
    if check_subscription(call.from_user.id):
        bot.answer_callback_query(call.id, "âœ… ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ø¢Ù†")
        # Restart to main menu
        user = User(call.from_user)
        markup = telebot.types.InlineKeyboardMarkup()
        markup.row(
            telebot.types.InlineKeyboardButton(text="ğŸ‡ªğŸ‡¬ Ù…ØµØ±", callback_data="country_select&Egypt"),
            telebot.types.InlineKeyboardButton(text="ğŸ‡ºğŸ‡¸ Ø£Ù…Ø±ÙŠÙƒØ§", callback_data="country_select&United_States")
        )
        markup.row(
            telebot.types.InlineKeyboardButton(text="ğŸ‡¬ğŸ‡§ Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ§", callback_data="country_select&United_Kingdom"),
            telebot.types.InlineKeyboardButton(text="ğŸ‡·ğŸ‡º Ø±ÙˆØ³ÙŠØ§", callback_data="country_select&Russian_Federation")
        )
        markup.add(telebot.types.InlineKeyboardButton(text="ğŸŒ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯ÙˆÙ„", callback_data="show_countries"))

        bot.edit_message_text(
            chat_id=call.message.chat.id,
            message_id=call.message.message_id,
            text=f"â€â´ Ù…Ø±Ø­Ø¨Ø§Ù‹ {user.pn}\nØ£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¨ÙˆØª Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ÙˆÙ‡Ù…ÙŠØ©\n\nØ§Ø®ØªØ± Ø§Ù„Ø¯ÙˆÙ„Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø±Ù‚Ù… ÙˆÙ‡Ù…ÙŠ Ù…Ø¬Ø§Ù†ÙŠ ğŸ“±",
            reply_markup=markup
        )
    else:
        bot.answer_callback_query(call.id, "âŒ Ù„Ù… ØªØ´ØªØ±Ùƒ ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø© Ø¨Ø¹Ø¯!", show_alert=True)

@bot.callback_query_handler(func=lambda x: x.data == "admin_toggle_bot")
def admin_toggle_bot_handler(call: ClassVar[Any]) -> NoReturn:
    """ØªÙØ¹ÙŠÙ„/ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø¨ÙˆØª Ù…Ø¹ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ø¯Ù…Ù†"""
    # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ø¯Ù…Ù†
    if not is_admin(call.from_user.id):
        bot.answer_callback_query(call.id, "âŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø±", show_alert=True)
        return

    # ØªØ¨Ø¯ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙˆØª
    bot_settings['bot_enabled'] = not bot_settings['bot_enabled']
    status = "Ù…ÙØ¹Ù„" if bot_settings['bot_enabled'] else "Ù…Ø¹Ø·Ù„"
    
    # Ø¥Ø±Ø³Ø§Ù„ ØªØ£ÙƒÙŠØ¯
    bot.answer_callback_query(call.id, f"âœ… ØªÙ… {status} Ø§Ù„Ø¨ÙˆØª", show_alert=True)

    # Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù† Ù…Ø¨Ø§Ø´Ø±Ø©
    back_to_admin_handler(call)
    

# ============= Ø§Ù„ØªØµØ­ÙŠØ­ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ - Ù†Ø¸Ø§Ù… Ø§Ù„Ø®Ø·ÙˆØ§Øª Ù…Ø¹ Ø§Ù„ØªØ­Ù‚Ù‚ =============

@bot.callback_query_handler(func=lambda x: x.data == "admin_set_forced")
def admin_set_forced_handler(call: ClassVar[Any]) -> NoReturn:
    """Ø¥Ø¶Ø§ÙØ© Ù‚Ù†Ø§Ø© Ø§Ø´ØªØ±Ø§Ùƒ Ø¥Ø¬Ø¨Ø§Ø±ÙŠ - Ù…Ø¶Ø¨ÙˆØ·"""
    if not is_admin(call.from_user.id):
        bot.answer_callback_query(call.id, "âŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ©", show_alert=True)
        return

    # Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø¯Ù„ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
    markup = telebot.types.InlineKeyboardMarkup()
    markup.add(telebot.types.InlineKeyboardButton(
        text="âŒ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",
        callback_data="cancel_operation"
    ))

    msg = bot.send_message(
        call.message.chat.id,
        "ğŸ”’ **Ø¥Ø¶Ø§ÙØ© Ø§Ø´ØªØ±Ø§Ùƒ Ø¥Ø¬Ø¨Ø§Ø±ÙŠ**\n\n"
        "Ø£Ø±Ø³Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ù‚Ù†Ø§Ø© (Ù…Ø«Ø§Ù„: @channel)\n\n"
        "âš ï¸ Ø§Ù„Ø´Ø±ÙˆØ·:\n"
        "â€¢ Ø§Ù„Ù‚Ù†Ø§Ø© ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø¹Ø§Ù…Ø©\n"
        "â€¢ Ø§Ù„Ø¨ÙˆØª ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£Ø¯Ù…Ù† ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø©\n"
        "â€¢ Ø§Ù„Ø¨ÙˆØª ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø±Ø¤ÙŠØ© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡\n\n"
        "Ø£Ùˆ Ø§Ø¶ØºØ· âŒ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",
        reply_markup=markup,
        parse_mode='Markdown'
    )
    
    # ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ© Ù…Ø¹ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
    bot.register_next_step_handler(msg, process_forced_channel)

def process_forced_channel(message):
    """Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù‚Ù†Ø§Ø© Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠØ© - Ù…Ø¶Ø¨ÙˆØ·"""
    # Ø§Ù„ØªØ­Ù‚Ù‚ Ø£ÙˆÙ„Ø§Ù‹ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ø¯Ù…Ù†
    if not is_admin(message.from_user.id):
        bot.reply_to(message, "âŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ©")
        return

    # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù†Øµ ÙˆÙ„ÙŠØ³Øª Ø£Ù…Ø±
    if not message.text or message.text.startswith('/'):
        if message.text == '/cancel':
            bot.reply_to(message, "âŒ ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©")
            return
        else:
            markup = telebot.types.InlineKeyboardMarkup()
            markup.add(telebot.types.InlineKeyboardButton(
                text="ğŸ”„ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",
                callback_data="admin_set_forced"
            ))
            bot.reply_to(message, "âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø±Ø³Ø§Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ù‚Ù†Ø§Ø© ÙÙ‚Ø·", reply_markup=markup)
            return

    channel_username = message.text.strip()
    
    # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙŠØºØ©
    if not channel_username.startswith('@'):
        markup = telebot.types.InlineKeyboardMarkup()
        markup.add(telebot.types.InlineKeyboardButton(
            text="ğŸ”„ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",
            callback_data="admin_set_forced"
        ))
        bot.reply_to(message, "âŒ ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¨Ø¯Ø£ Ù…Ø¹Ø±Ù Ø§Ù„Ù‚Ù†Ø§Ø© Ø¨ @ Ù…Ø«Ø§Ù„: @channel", reply_markup=markup)
        return

    # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù‚Ù†Ø§Ø©
    try:
        chat = bot.get_chat(channel_username)
        if chat.type not in ['channel', 'group', 'supergroup']:
            raise Exception("Ù„ÙŠØ³Øª Ù‚Ù†Ø§Ø© Ø£Ùˆ Ù…Ø¬Ù…ÙˆØ¹Ø©")
    except Exception as e:
        markup = telebot.types.InlineKeyboardMarkup()
        markup.add(telebot.types.InlineKeyboardButton(
            text="ğŸ”„ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",
            callback_data="admin_set_forced"
        ))
        bot.reply_to(message, f"âŒ Ø§Ù„Ù‚Ù†Ø§Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© Ø£Ùˆ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„ÙŠÙ‡Ø§", reply_markup=markup)
        return

    # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø¨ÙˆØª Ø£Ø¯Ù…Ù† ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø©
    try:
        bot_user = bot.get_me()
        member = bot.get_chat_member(channel_username, bot_user.id)
        if member.status not in ['administrator', 'creator']:
            raise Exception("Ø§Ù„Ø¨ÙˆØª Ù„ÙŠØ³ Ø£Ø¯Ù…Ù†")
    except Exception as e:
        markup = telebot.types.InlineKeyboardMarkup()
        markup.add(telebot.types.InlineKeyboardButton(
            text="ğŸ”„ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",
            callback_data="admin_set_forced"
        ))
        bot.reply_to(
            message, 
            "âŒ Ø§Ù„Ø¨ÙˆØª Ù„ÙŠØ³ Ø£Ø¯Ù…Ù† ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø©!\n\n"
            "ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø§Ù„Ø¨ÙˆØª Ø£Ø¯Ù…Ù† ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø© Ù…Ø¹ ØµÙ„Ø§Ø­ÙŠØ© Ø±Ø¤ÙŠØ© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡",
            reply_markup=markup
        )
        return

    # Ø­ÙØ¸ Ø§Ù„Ù‚Ù†Ø§Ø©
    bot_settings['forced_channel'] = "@velkor_crash"
    
    # ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ©
    markup = telebot.types.InlineKeyboardMarkup()
    markup.add(telebot.types.InlineKeyboardButton(
        text="ğŸ”™ Ø±Ø¬ÙˆØ¹ Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†",
        callback_data="back_to_admin"
    ))

    bot.reply_to(
        message,
        f"âœ… ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠ: {channel_username}\n\n"
        f"ğŸ“ Ù†ÙˆØ¹ Ø§Ù„Ù‚Ù†Ø§Ø©: {chat.type}\n"
        f"ğŸ‘¥ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù‚Ù†Ø§Ø©: {chat.title}",
        reply_markup=markup
    )

@bot.callback_query_handler(func=lambda x: x.data == "admin_set_activation")
def admin_set_activation_handler(call: ClassVar[Any]) -> NoReturn:
    """Ø¥Ø¶Ø§ÙØ© Ù‚Ù†Ø§Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„Ø§Øª - Ù…Ø¶Ø¨ÙˆØ·"""
    if not is_admin(call.from_user.id):
        bot.answer_callback_query(call.id, "âŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ©", show_alert=True)
        return

    # Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©
    markup = telebot.types.InlineKeyboardMarkup()
    markup.add(telebot.types.InlineKeyboardButton(
        text="âŒ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",
        callback_data="cancel_operation"
    ))

    msg = bot.send_message(
        call.message.chat.id,
        "ğŸ“¢ **Ø¥Ø¶Ø§ÙØ© Ù‚Ù†Ø§Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„Ø§Øª**\n\n"
        "Ø£Ø±Ø³Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ù‚Ù†Ø§Ø© (Ù…Ø«Ø§Ù„: @channel)\n\n"
        "âš ï¸ Ø§Ù„Ø´Ø±ÙˆØ·:\n"
        "â€¢ Ø§Ù„Ù‚Ù†Ø§Ø© ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø¹Ø§Ù…Ø©\n"
        "â€¢ Ø§Ù„Ø¨ÙˆØª ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù…Ø´ØªØ±Ùƒ ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø©\n\n"
        "Ø£Ùˆ Ø§Ø¶ØºØ· âŒ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",
        reply_markup=markup,
        parse_mode='Markdown'
    )
    
    bot.register_next_step_handler(msg, process_activation_channel)

def process_activation_channel(message):
    """Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¥Ø¯Ø®Ø§Ù„ Ù‚Ù†Ø§Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„Ø§Øª - Ù…Ø¶Ø¨ÙˆØ·"""
    # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ø¯Ù…Ù†
    if not is_admin(message.from_user.id):
        bot.reply_to(message, "âŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ©")
        return

    # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù†Øµ
    if not message.text or message.text.startswith('/'):
        if message.text == '/cancel':
            bot.reply_to(message, "âŒ ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©")
            return
        else:
            markup = telebot.types.InlineKeyboardMarkup()
            markup.add(telebot.types.InlineKeyboardButton(
                text="ğŸ”„ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",
                callback_data="admin_set_activation"
            ))
            bot.reply_to(message, "âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø±Ø³Ø§Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ù‚Ù†Ø§Ø© ÙÙ‚Ø·", reply_markup=markup)
            return

    channel_username = message.text.strip()
    
    # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙŠØºØ©
    if not channel_username.startswith('@'):
        markup = telebot.types.InlineKeyboardMarkup()
        markup.add(telebot.types.InlineKeyboardButton(
            text="ğŸ”„ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",
            callback_data="admin_set_activation"
        ))
        bot.reply_to(message, "âŒ ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¨Ø¯Ø£ Ù…Ø¹Ø±Ù Ø§Ù„Ù‚Ù†Ø§Ø© Ø¨ @ Ù…Ø«Ø§Ù„: @channel", reply_markup=markup)
        return

    # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù‚Ù†Ø§Ø©
    try:
        chat = bot.get_chat(channel_username)
        if chat.type not in ['channel', 'group', 'supergroup']:
            raise Exception("Ù„ÙŠØ³Øª Ù‚Ù†Ø§Ø© Ø£Ùˆ Ù…Ø¬Ù…ÙˆØ¹Ø©")
    except Exception as e:
        markup = telebot.types.InlineKeyboardMarkup()
        markup.add(telebot.types.InlineKeyboardButton(
            text="ğŸ”„ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",
            callback_data="admin_set_activation"
        ))
        bot.reply_to(message, "âŒ Ø§Ù„Ù‚Ù†Ø§Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© Ø£Ùˆ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„ÙŠÙ‡Ø§", reply_markup=markup)
        return

    # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø¨ÙˆØª Ù…Ø´ØªØ±Ùƒ ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø©
    try:
        bot_user = bot.get_me()
        member = bot.get_chat_member(channel_username, bot_user.id)
        if member.status not in ['member', 'administrator', 'creator']:
            raise Exception("Ø§Ù„Ø¨ÙˆØª Ù„ÙŠØ³ Ù…Ø´ØªØ±Ùƒ")
    except Exception as e:
        markup = telebot.types.InlineKeyboardMarkup()
        markup.add(telebot.types.InlineKeyboardButton(
            text="ğŸ”„ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",
            callback_data="admin_set_activation"
        ))
        bot.reply_to(message, "âŒ Ø§Ù„Ø¨ÙˆØª Ù„ÙŠØ³ Ù…Ø´ØªØ±Ùƒ ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø©", reply_markup=markup)
        return

    # Ø­ÙØ¸ Ø§Ù„Ù‚Ù†Ø§Ø©
    bot_settings['activation_channel'] = channel_username
    
    # ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ©
    markup = telebot.types.InlineKeyboardMarkup()
    markup.add(telebot.types.InlineKeyboardButton(
        text="ğŸ”™ Ø±Ø¬ÙˆØ¹ Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†",
        callback_data="back_to_admin"
    ))

    bot.reply_to(
        message,
        f"âœ… ØªÙ… ØªØ¹ÙŠÙŠÙ† Ù‚Ù†Ø§Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„Ø§Øª: {channel_username}\n\n"
        f"ğŸ“ Ù†ÙˆØ¹ Ø§Ù„Ù‚Ù†Ø§Ø©: {chat.type}\n"
        f"ğŸ‘¥ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù‚Ù†Ø§Ø©: {chat.title}",
        reply_markup=markup
    )

# ============= Ø²Ø± Ø§Ù„Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ø§Ù… =============

@bot.callback_query_handler(func=lambda x: x.data == "cancel_operation")
def cancel_operation_handler(call: ClassVar[Any]) -> NoReturn:
    """Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ© - Ù…Ø¶Ø¨ÙˆØ·"""
    if not is_admin(call.from_user.id):
        bot.answer_callback_query(call.id, "âŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ©", show_alert=True)
        return

    markup = telebot.types.InlineKeyboardMarkup()
    markup.add(telebot.types.InlineKeyboardButton(
        text="ğŸ”™ Ø±Ø¬ÙˆØ¹ Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†",
        callback_data="back_to_admin"
    ))

    bot.edit_message_text(
        chat_id=call.message.chat.id,
        message_id=call.message.message_id,
        text="âŒ ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",
        reply_markup=markup
    )

# ============= Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù† - Ù…Ø¶Ø¨ÙˆØ· =============

@bot.callback_query_handler(func=lambda x: x.data == "back_to_admin")
def back_to_admin_handler(call: ClassVar[Any]) -> NoReturn:
    """Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù† - Ù…Ø¶Ø¨ÙˆØ·"""
    if not is_admin(call.from_user.id):
        bot.answer_callback_query(call.id, "âŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ©", show_alert=True)
        return

    # Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ù†Ø´Ø§Ø¡ Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†
    markup = telebot.types.InlineKeyboardMarkup()

    # Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙˆØª
    markup.row(
        telebot.types.InlineKeyboardButton(
            text=f"ğŸ¤– Ø§Ù„Ø¨ÙˆØª: {'ğŸŸ¢ Ù…ÙÙØ¹Ù‘Ù„' if bot_settings['bot_enabled'] else 'ğŸ”´ Ù…ÙØ¹Ø·Ù‘Ù„'}",
            callback_data="admin_toggle_bot"
        )
    )

    # Ù‚Ù†ÙˆØ§Øª
    markup.row(
        telebot.types.InlineKeyboardButton(
            text="ğŸ“¢ Ø¥Ø¶Ø§ÙØ© Ù‚Ù†Ø§Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„Ø§Øª",
            callback_data="admin_set_activation"
        )
    )
    
    if bot_settings['activation_channel']:
        markup.row(
            telebot.types.InlineKeyboardButton(
                text="ğŸ—‘ Ø­Ø°Ù Ù‚Ù†Ø§Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„Ø§Øª",
                callback_data="admin_remove_activation"
            )
        )

    markup.row(
        telebot.types.InlineKeyboardButton(
            text="ğŸ”’ Ø¥Ø¶Ø§ÙØ© Ø§Ø´ØªØ±Ø§Ùƒ Ø¥Ø¬Ø¨Ø§Ø±ÙŠ", 
            callback_data="admin_set_forced"
        )
    )
    
    if bot_settings['forced_channel']:
        markup.row(
            telebot.types.InlineKeyboardButton(
                text="ğŸ—‘ Ø­Ø°Ù Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠ",
                callback_data="admin_remove_forced"
            )
        )

    # Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆØ¨Ø«
    markup.row(
        telebot.types.InlineKeyboardButton(
            text="ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª",
            callback_data="admin_stats"
        ),
        telebot.types.InlineKeyboardButton(
            text="ğŸ“£ Ø¨Ø« Ø¬Ù…Ø§Ø¹ÙŠ",
            callback_data="admin_broadcast"
        )
    )

    bot.edit_message_text(
        chat_id=call.message.chat.id,
        message_id=call.message.message_id,
        text=(
            "ğŸ› **Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ†**\n\n"
            f"ğŸ‘¤ Ø§Ù„Ù…Ø·ÙˆØ±: {call.from_user.first_name}\n"
            f"ğŸ†” Ø§Ù„Ø£ÙŠØ¯ÙŠ: `{call.from_user.id}`\n\n"
            "ğŸ“¢ Ù‚Ù†Ø§Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„Ø§Øª: " + (f"`{bot_settings['activation_channel']}`" if bot_settings['activation_channel'] else "âŒ ØºÙŠØ± Ù…Ø¶Ø¨ÙˆØ·Ø©") + "\n"
            "ğŸ”’ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠ: " + (f"`{bot_settings['forced_channel']}`" if bot_settings['forced_channel'] else "âŒ ØºÙŠØ± Ù…ÙØ¹Ù„") + "\n\n"
            "Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:"
        ),
        reply_markup=markup,
        parse_mode='Markdown'
    )
    bot.answer_callback_query(call.id, "ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†")


@bot.callback_query_handler(func=lambda x: x.data == "admin_devs")
def admin_devs_handler(call: ClassVar[Any]) -> NoReturn:
    """Show developers list"""
    if not is_admin(call.from_user.id):
        bot.answer_callback_query(call.id, "âŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ©")
        return

    markup = telebot.types.InlineKeyboardMarkup()
    markup.add(telebot.types.InlineKeyboardButton(
        text="ğŸ”™ Ø±Ø¬ÙˆØ¹",
        callback_data="back_to_admin"
    ))

    devs_text = "ğŸ‘¥ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ†:\n\n"
    for i, dev_id in enumerate(ADMIN_IDS, 1):
        devs_text += f"{i}. `{dev_id}`\n"

    bot.edit_message_text(
        chat_id=call.message.chat.id,
        message_id=call.message.message_id,
        text=devs_text,
        reply_markup=markup,
        parse_mode='Markdown'
    )

@bot.callback_query_handler(func=lambda x: x.data == "back_to_admin")
def back_to_admin_handler(call: ClassVar[Any]) -> NoReturn:
    """Back to admin panel"""
    admin_panel_handler(call.message)
    bot.answer_callback_query(call.id)

@bot.callback_query_handler(func=lambda x: x.data.startswith("country_page"))
def country_page_handler(call: ClassVar[Any]) -> NoReturn:
    """Callback query handler for country pagination"""
    try:
        _, page_str = call.data.split("&")
        page = int(page_str)
        send_country_list(call.message.chat.id, call.message.message_id, page)
        bot.answer_callback_query(callback_query_id=call.id, text=f"Ø§Ù„ØµÙØ­Ø© {page + 1}")
    except Exception as e:
        print(f"Error in country_page_handler: {e}")
        try:
            bot.answer_callback_query(callback_query_id=call.id, text="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£")
        except:
            pass


@bot.callback_query_handler(func=lambda x: x.data.startswith("country_select"))
def country_select_handler(call: ClassVar[Any]) -> NoReturn:
    """Callback query handler for country selection - selects verified number"""
    try:
        _, country_name = call.data.split("&")
        bot.edit_message_text(
            chat_id=call.message.chat.id,
            message_id=call.message.message_id,
            text=f"ğŸ” Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ø±Ù‚Ø§Ù… {country_name.replace('_', ' ').title()}..."
        )

        def select_verified_number():
            try:
                engine = VNEngine()
                numbers = engine.get_country_numbers(country=country_name)

                if not numbers:
                    markup = telebot.types.InlineKeyboardMarkup()
                    markup.add(telebot.types.InlineKeyboardButton(
                        text="ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¯ÙˆÙ„",
                        callback_data="back_to_countries"
                    ))
                    bot.edit_message_text(
                        chat_id=call.message.chat.id,
                        message_id=call.message.message_id,
                        text=f"âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø±Ù‚Ø§Ù… Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹ ÙÙŠ {country_name.replace('_', ' ').title()}",
                        reply_markup=markup
                    )
                    return

                # Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø±Ù‚Ù… Ù…Ù† Ø§Ù„Ø¯ÙˆÙ„Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© (10 Ù…Ø­Ø§ÙˆÙ„Ø§Øª ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰)
                attempts = 0
                max_attempts = min(20, len(numbers))
                
                for attempt in range(max_attempts):
                    random_number = random.choice(numbers)
                    number = random_number[1]
                    attempts += 1
                    
                    # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø±Ù‚Ù… Ù…Ù† Ø§Ù„Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
                    if verify_number_country(number, country_name):
                        print(f"âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø±Ù‚Ù… {country_name} ØµØ­ÙŠØ­: {number}")
                        # Ø¹Ø±Ø¶ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØµØ­ÙŠØ­
                        display_selected_number(call.message.chat.id, call.message.message_id, country_name, number)
                        return
                    else:
                        print(f"âŒ Ø§Ù„Ø±Ù‚Ù… {number} Ù„ÙŠØ³ Ù…Ù† {country_name} - Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© {attempts}")
                        continue

                # Ø¥Ø°Ø§ Ù„Ù… ÙŠØ¬Ø¯ Ø±Ù‚Ù… Ù…Ù† Ø§Ù„Ø¯ÙˆÙ„Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©
                markup = telebot.types.InlineKeyboardMarkup()
                markup.add(telebot.types.InlineKeyboardButton(
                    text="ğŸ”„ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",
                    callback_data=f"country_select&{country_name}"
                ))
                markup.add(telebot.types.InlineKeyboardButton(
                    text="ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¯ÙˆÙ„", 
                    callback_data="back_to_countries"
                ))
                
                bot.edit_message_text(
                    chat_id=call.message.chat.id,
                    message_id=call.message.message_id,
                    text=f"âŒ Ù„Ù… Ø£ØªÙ…ÙƒÙ† Ù…Ù† Ø¥ÙŠØ¬Ø§Ø¯ Ø£Ø±Ù‚Ø§Ù… {country_name.replace('_', ' ').title()} Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹\n\nØ¬Ø±Ø¨ Ø¯ÙˆÙ„Ø© Ø£Ø®Ø±Ù‰ Ø£Ùˆ Ø­Ø§ÙˆÙ„ Ù„Ø§Ø­Ù‚Ø§Ù‹",
                    reply_markup=markup
                )

            except Exception as e:
                print(f"Error selecting verified number: {e}")
                try:
                    markup = telebot.types.InlineKeyboardMarkup()
                    markup.add(telebot.types.InlineKeyboardButton(
                        text="ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¯ÙˆÙ„",
                        callback_data="back_to_countries"
                    ))
                    bot.edit_message_text(
                        chat_id=call.message.chat.id,
                        message_id=call.message.message_id,
                        text=f"âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ø®ØªÙŠØ§Ø± Ø±Ù‚Ù… Ù…Ù† {country_name.replace('_', ' ').title()}",
                        reply_markup=markup
                    )
                except:
                    pass

        thread = threading.Thread(target=select_verified_number)
        thread.daemon = True
        thread.start()

    except Exception as e:
        print(f"Error in country_select_handler: {e}")
        try:
            bot.answer_callback_query(callback_query_id=call.id, text="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¯ÙˆÙ„Ø©")
        except:
            pass

def send_country_numbers(chat_id: int, message_id: int, country_name: str, page: int = 0) -> NoReturn:
    """Function to send available numbers for a specific country"""
    try:
        items_per_page = 6
        engine: ClassVar[Any] = VNEngine()

        try:
            numbers: List[Dict[str, str]] = engine.get_country_numbers(country=country_name)
        except Exception as e:
            print(f"Error getting numbers for {country_name}: {e}")
            markup = telebot.types.InlineKeyboardMarkup()
            markup.add(telebot.types.InlineKeyboardButton(
                text="ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¯ÙˆÙ„",
                callback_data="back_to_countries"
            ))
            bot.edit_message_text(
                chat_id=chat_id,
                message_id=message_id,
                text=f"âŒ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù… Ù„Ø¬Ù„Ø¨ Ø£Ø±Ù‚Ø§Ù… {country_name.replace('_', ' ').title()}",
                reply_markup=markup
            )
            return

        if not numbers:
            markup = telebot.types.InlineKeyboardMarkup()
            markup.add(telebot.types.InlineKeyboardButton(
                text="ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¯ÙˆÙ„",
                callback_data="back_to_countries"
            ))
            bot.edit_message_text(
                chat_id=chat_id,
                message_id=message_id,
                text=f"âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø±Ù‚Ø§Ù… Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹ ÙÙŠ {country_name.replace('_', ' ').title()}",
                reply_markup=markup
            )
            return

        start_index = page * items_per_page
        end_index = start_index + items_per_page
        numbers_to_display = numbers[start_index:end_index]

        markup = telebot.types.InlineKeyboardMarkup()

        for number in numbers_to_display:
            try:
                parsed_number = phonenumbers.parse(f"+{number[1]}")
                formatted_number = phonenumbers.format_number(
                    numobj=parsed_number,
                    num_format=phonenumbers.PhoneNumberFormat.NATIONAL
                )
            except:
                formatted_number = number[1]

            markup.add(telebot.types.InlineKeyboardButton(
                text=f"ğŸ“± {formatted_number} | {number[0]}",
                callback_data=f"select_number&{country_name}&{number[1]}"
            ))

        navigation_buttons = []
        if page > 0:
            navigation_buttons.append(telebot.types.InlineKeyboardButton(
                text="â—€ï¸ Ø§Ù„Ø³Ø§Ø¨Ù‚",
                callback_data=f"numbers_page&{country_name}&{page - 1}"
            ))
        if end_index < len(numbers):
            navigation_buttons.append(telebot.types.InlineKeyboardButton(
                text="Ø§Ù„ØªØ§Ù„ÙŠ â–¶ï¸",
                callback_data=f"numbers_page&{country_name}&{page + 1}"
            ))

        if navigation_buttons:
            markup.row(*navigation_buttons)

        markup.add(telebot.types.InlineKeyboardButton(
            text="ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¯ÙˆÙ„",
            callback_data="back_to_countries"
        ))

        country_flag = "ğŸ³ï¸"
        for country in COUNTRIES_DATA:
            if country["name"].lower().replace(" ", "_") == country_name.lower():
                country_flag = country["flag"]
                break

        text = (f"{country_flag} Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…ØªØ§Ø­Ø© ÙÙŠ {country_name.replace('_', ' ').title()}:\n\n"
                f"Ø§Ù„ØµÙØ­Ø© {page + 1} Ù…Ù† {(len(numbers) - 1) // items_per_page + 1}\n"
                f"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…: {len(numbers)}")

        bot.edit_message_text(
            chat_id=chat_id,
            message_id=message_id,
            text=text,
            reply_markup=markup
        )
    except Exception as e:
        print(f"Error in send_country_numbers: {e}")


@bot.callback_query_handler(func=lambda x: x.data.startswith("s2msg"))
def server2_messages_handler(call: ClassVar[Any]) -> NoReturn:
    """Handle messages check for server 2 numbers"""
    try:
        _, country_code, source_id = call.data.split("&")
        # Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ù‚Ù… Ù…Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† callback data
        number = call.message.text.split("Ø§Ù„Ø±Ù‚Ù… | ")[1].split(" â˜ï¸")[0]
        # Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙˆÙ‚Ø¹ Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹
        source = random.choice(SMS_WEBSITES)['url']

        bot.answer_callback_query(
            callback_query_id=call.id,
            text="ğŸ” Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„...",
            show_alert=False
        )

        # Ø¬Ù„Ø¨ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ù…Ù† Ø§Ù„Ù…ØµØ¯Ø±
        scraper = FreeNumbersScraper()
        messages = scraper.get_messages_from_website(source, number)

        if not messages:
            bot.send_message(
                chat_id=call.message.chat.id,
                reply_to_message_id=call.message.message_id,
                text="âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø³Ø§Ø¦Ù„ Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù…"
            )
            return

        # ØªØµÙÙŠØ© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ù…Ù† 1-3 Ø¯Ù‚Ø§Ø¦Ù‚ ÙÙ‚Ø·
        valid_messages = []
        for message in messages:
            for time_text, message_text in message.items():
                # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ù† 1-3 Ø¯Ù‚Ø§Ø¦Ù‚
                if "Ø¯Ù‚ÙŠÙ‚Ø©" in time_text or "minute" in time_text.lower():
                    numbers = re.findall(r'\d+', time_text)
                    if numbers:
                        minutes = int(numbers[0])
                        if 1 <= minutes <= 3:
                            valid_messages.append({time_text: message_text})

        if not valid_messages:
            bot.send_message(
                chat_id=call.message.chat.id,
                reply_to_message_id=call.message.message_id,
                text="âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø³Ø§Ø¦Ù„ Ù…Ù† Ø¢Ø®Ø± 1-3 Ø¯Ù‚Ø§Ø¦Ù‚"
            )
            return

        # Ø¹Ø±Ø¶ Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© ÙÙ‚Ø· (Ø§Ù„Ø£Ø­Ø¯Ø«)
        latest_message = valid_messages[0]
        for time_text, message_text in latest_message.items():
            bot.send_message(
                chat_id=call.message.chat.id,
                reply_to_message_id=call.message.message_id,
                text=(
                    f"âš¯Í› Ø§Ù„ÙˆÙ‚Øª: {time_text}\n\n"
                    f"{message_text}"
                )
            )
            break

    except Exception as e:
        print(f"Error in server2_messages_handler: {e}")
        try:
            bot.send_message(
                chat_id=call.message.chat.id,
                reply_to_message_id=call.message.message_id,
                text="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„"
            )
        except:
            pass


        try:
            markup = telebot.types.InlineKeyboardMarkup()
            markup.add(telebot.types.InlineKeyboardButton(
                text="ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¯ÙˆÙ„",
                callback_data="back_to_countries"
            ))
            bot.edit_message_text(
                chat_id=chat_id,
                message_id=message_id,
                text="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…",
                reply_markup=markup
            )
        except:
            pass


@bot.callback_query_handler(func=lambda x: x.data.startswith("numbers_page"))
def numbers_page_handler(call: ClassVar[Any]) -> NoReturn:
    """Callback query handler for numbers pagination"""
    try:
        _, country_name, page_str = call.data.split("&")
        page = int(page_str)
        send_country_numbers(call.message.chat.id, call.message.message_id, country_name, page)
        bot.answer_callback_query(callback_query_id=call.id, text=f"Ø§Ù„ØµÙØ­Ø© {page + 1}")
    except Exception as e:
        print(f"Error in numbers_page_handler: {e}")
        try:
            bot.answer_callback_query(callback_query_id=call.id, text="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£")
        except:
            pass


@bot.callback_query_handler(func=lambda x: x.data == "back_to_countries")
def back_to_countries_handler(call: ClassVar[Any]) -> NoReturn:
    """Callback query handler to go back to countries list"""
    try:
        send_country_list(call.message.chat.id, call.message.message_id, 0)
        bot.answer_callback_query(callback_query_id=call.id, text="Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯ÙˆÙ„")
    except Exception as e:
        print(f"Error in back_to_countries_handler: {e}")
        try:
            bot.answer_callback_query(callback_query_id=call.id, text="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£")
        except:
            pass


def display_selected_number(chat_id: int, message_id: int, country_name: str, number: str) -> NoReturn:
    """Function to display selected number details"""
    try:
        # Ø¬Ù„Ø¨ ÙƒÙˆØ¯ Ø§Ù„Ø¯ÙˆÙ„Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
        country_dial_code = ""
        country_flag = "ğŸ³ï¸"
        for country in COUNTRIES_DATA:
            if country["name"].lower().replace(" ", "_") == country_name.lower():
                country_dial_code = country["dial_code"]
                country_flag = country["flag"]
                break

        # ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø±Ù‚Ù… Ù…Ø¹ ÙƒÙˆØ¯ Ø§Ù„Ø¯ÙˆÙ„Ø©
        if country_dial_code and not number.startswith(country_dial_code.replace('+', '')):
            formatted_number = f"+{number}"  # Ø¹Ø±Ø¶ Ø§Ù„Ø±Ù‚Ù… ÙƒÙ…Ø§ Ù‡Ùˆ Ù…Ù† API
        else:
            formatted_number = f"+{number}"

        engine = VNEngine()
        try:
            messages = engine.get_number_inbox(country=country_name, number=number)
            status = get_number_status(messages)
        except:
            status = "â›” ØºÙŠØ± Ù…Ø³ØªÙ‚Ø± (Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„)"

        markup = telebot.types.InlineKeyboardMarkup()
        markup.row(
            telebot.types.InlineKeyboardButton(
                text="ğŸ“¨ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„",
                callback_data=f"msg&{country_name}&{number}"
            ),
            telebot.types.InlineKeyboardButton(
                text="ğŸ”„ Ø±Ù‚Ù… Ø¢Ø®Ø±",
                callback_data=f"another_number&{country_name}"
            )
        )
        markup.add(telebot.types.InlineKeyboardButton(
            text="ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¯ÙˆÙ„",
            callback_data="back_to_countries"
        ))
        markup.add(telebot.types.InlineKeyboardButton(
            text="ğŸ  Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
            callback_data="main_menu"
        ))

        order_id = random.randint(100000000, 999999999)
        operation_id = random.randint(1000000000, 9999999999)
        current_time = datetime.now().strftime("%Y-%m-%d %H:%M:%S")

        text = (f"â– Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨ | {order_id} ğŸ›â€¢\n"
                f"â– Ø§Ù„Ø¯ÙˆÙ„Ø© | {country_flag} {country_name.replace('_', ' ').title()} â€¢\n"
                f"â– Ø§Ù„Ø±Ù‚Ù… | {formatted_number} â˜ï¸â€¢\n"
                f"â– Ø§Ù„ÙƒÙˆØ¯ | ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± ğŸ“©â€¢\n"
                f"â– Ø§Ù„Ø­Ø§Ù„Ø© | {status} ğŸ”â€¢\n"
                f"â– Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ : Ø±Ù‚Ù… ÙˆÙ‡Ù…ÙŠ â€¢\n"
                f"â– Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠØ© : {operation_id} â€¢\n"
                f"â– Ø§Ù„Ø³Ø¹Ø± | 0.00$ ğŸ’™â€¢\n"
                f"â– ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ : {current_time} â€¢ ğŸ“«â€¢\n"
                f"â– ÙŠÙ†ØªÙ‡ÙŠ : 30:00 ğŸ“­â€¢\n"
                f"â– Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª : 1 â€¢")

        bot.edit_message_text(
            chat_id=chat_id,
            message_id=message_id,
            text=text,
            reply_markup=markup
        )
    except Exception as e:
        print(f"Error in display_selected_number: {e}")

@bot.callback_query_handler(func=lambda x: x.data.startswith("select_number"))
def select_number_handler(call: ClassVar[Any]) -> NoReturn:
    """Callback query handler for number selection"""
    try:
        _, country_name, number = call.data.split("&")
        display_selected_number(call.message.chat.id, call.message.message_id, country_name, number)
        bot.answer_callback_query(callback_query_id=call.id, text=f"ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø±Ù‚Ù… +{number}")
    except Exception as e:
        print(f"Error in select_number_handler: {e}")
        try:
            bot.answer_callback_query(callback_query_id=call.id, text="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø±Ù‚Ù…")
        except:
            pass


@bot.callback_query_handler(func=lambda x: x.data.startswith("back_to_numbers"))
def back_to_numbers_handler(call: ClassVar[Any]) -> NoReturn:
    """Callback query handler to go back to numbers list"""
    try:
        _, country_name = call.data.split("&")
        send_country_numbers(call.message.chat.id, call.message.message_id, country_name, 0)
        bot.answer_callback_query(callback_query_id=call.id, text=f"Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ø£Ø±Ù‚Ø§Ù… {country_name.replace('_', ' ').title()}")
    except Exception as e:
        print(f"Error in back_to_numbers_handler: {e}")
        try:
            bot.answer_callback_query(callback_query_id=call.id, text="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£")
        except:
            pass


@bot.callback_query_handler(func=lambda x: x.data == "select_server_1")
def select_server_1_handler(call: ClassVar[Any]) -> NoReturn:
    """Server 1 - OnlineSim API selection"""
    try:
        user = User(call.from_user)
        markup = telebot.types.InlineKeyboardMarkup()

        # Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¯ÙˆÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹Ø© Ù„Ù„Ø³ÙŠØ±ÙØ± 1
        markup.row(
            telebot.types.InlineKeyboardButton(text="ğŸ‡ªğŸ‡¬ Ù…ØµØ±", callback_data="country_select&Egypt"),
            telebot.types.InlineKeyboardButton(text="ğŸ‡ºğŸ‡¸ Ø£Ù…Ø±ÙŠÙƒØ§", callback_data="country_select&United_States")
        )
        markup.row(
            telebot.types.InlineKeyboardButton(text="ğŸ‡¬ğŸ‡§ Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ§", callback_data="country_select&United_Kingdom"),
            telebot.types.InlineKeyboardButton(text="ğŸ‡·ğŸ‡º Ø±ÙˆØ³ÙŠØ§", callback_data="country_select&Russian_Federation")
        )
        markup.row(
            telebot.types.InlineKeyboardButton(text="ğŸ‡®ğŸ‡© Ø¥Ù†Ø¯ÙˆÙ†ÙŠØ³ÙŠØ§", callback_data="country_select&Indonesia"),
            telebot.types.InlineKeyboardButton(text="ğŸ‡²ğŸ‡¾ Ù…Ø§Ù„ÙŠØ²ÙŠØ§", callback_data="country_select&Malaysia")
        )
        markup.add(telebot.types.InlineKeyboardButton(text="ğŸŒ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯ÙˆÙ„", callback_data="show_countries"))
        markup.add(telebot.types.InlineKeyboardButton(text="ğŸ”™ Ø±Ø¬ÙˆØ¹ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©", callback_data="main_menu"))

        bot.edit_message_text(
            chat_id=call.message.chat.id,
            message_id=call.message.message_id,
            text=(
                f"ğŸ”µ Ø³ÙŠØ±ÙØ± 1   \n\n"
                f"Ù…Ø±Ø­Ø¨Ø§Ù‹ {user.pn}\n"
                "Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆÙ„Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø±Ù‚Ù… ÙˆÙ‡Ù…ÙŠ ğŸ“±"
            ),
            reply_markup=markup
        )
        bot.answer_callback_query(call.id, "âœ… ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø³ÙŠØ±ÙØ± 1")
    except Exception as e:
        print(f"Error in select_server_1_handler: {e}")

@bot.callback_query_handler(func=lambda x: x.data == "select_server_2")
def select_server_2_handler(call: ClassVar[Any]) -> NoReturn:
    """Server 2 - Free numbers from websites"""
    try:
        user = User(call.from_user)
        markup = telebot.types.InlineKeyboardMarkup()

        # Ø¹Ø±Ø¶ Ø§Ù„Ø¯ÙˆÙ„ Ø§Ù„Ù…ØªØ§Ø­Ø©
        for i in range(0, len(SERVER2_COUNTRIES), 2):
            row_buttons = []
            for j in range(2):
                if i + j < len(SERVER2_COUNTRIES):
                    country = SERVER2_COUNTRIES[i + j]
                    row_buttons.append(telebot.types.InlineKeyboardButton(
                        text=f"{country['flag']} {country['name']}",
                        callback_data=f"server2_country&{country['code']}"
                    ))
            markup.row(*row_buttons)

        markup.add(telebot.types.InlineKeyboardButton(
            text="ğŸ”™ Ø±Ø¬ÙˆØ¹ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
            callback_data="main_menu"
        ))

        bot.edit_message_text(
            chat_id=call.message.chat.id,
            message_id=call.message.message_id,
            text=(
                f"ğŸŸ¢ Ø³ÙŠØ±ÙØ± 2 -  \n\n"
                f"Ù…Ø±Ø­Ø¨Ø§Ù‹ {user.pn}\n"
                f"ğŸ“Š Ø¹Ø¯Ø¯ Ø§Ù„Ø¯ÙˆÙ„ Ø§Ù„Ù…ØªØ§Ø­Ø©: {len(SERVER2_COUNTRIES)}\n"
                f"ğŸŒ ÙŠØªÙ… Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ù…Ù† {len(SMS_WEBSITES)} Ù…ÙˆÙ‚Ø¹\n\n"
                "Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆÙ„Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø±Ù‚Ù… ÙˆÙ‡Ù…ÙŠ ğŸ“±"
            ),
            reply_markup=markup
        )
        bot.answer_callback_query(call.id, "âœ… ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø³ÙŠØ±ÙØ± 2")
    except Exception as e:
        print(f"Error in select_server_2_handler: {e}")

@bot.callback_query_handler(func=lambda x: x.data.startswith("server2_country"))
def server2_country_handler(call: ClassVar[Any]) -> NoReturn:
    """Handle server 2 country selection"""
    try:
        _, country_code = call.data.split("&")

        # Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¯ÙˆÙ„Ø©
        country = next((c for c in SERVER2_COUNTRIES if c['code'] == country_code), None)
        if not country:
            bot.answer_callback_query(call.id, "âŒ Ø¯ÙˆÙ„Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©")
            return

        bot.edit_message_text(
            chat_id=call.message.chat.id,
            message_id=call.message.message_id,
            text=f"ğŸ” Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ø±Ù‚Ø§Ù… Ù…Ù† {country['flag']} {country['name']}..."
        )

        def get_random_number():
            try:
                scraper = FreeNumbersScraper()
                all_numbers = []

                # Ø¬Ù„Ø¨ Ø£Ø±Ù‚Ø§Ù… Ù…Ù† 10 Ù…ÙˆØ§Ù‚Ø¹ Ù„ØªØ³Ø±ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
                for website in random.sample(SMS_WEBSITES, min(10, len(SMS_WEBSITES))):
                    numbers = scraper.get_numbers_from_website(website['url'])
                    all_numbers.extend(numbers)

                if not all_numbers:
                    markup = telebot.types.InlineKeyboardMarkup()
                    markup.add(telebot.types.InlineKeyboardButton(
                        text="ğŸ”„ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",
                        callback_data=f"server2_country&{country['code']}"
                    ))
                    markup.add(telebot.types.InlineKeyboardButton(
                        text="ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¯ÙˆÙ„",
                        callback_data="select_server_2"
                    ))
                    bot.edit_message_text(
                        chat_id=call.message.chat.id,
                        message_id=call.message.message_id,
                        text=f"âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¢Ù† Ù…Ù† {country['flag']} {country['name']}\n\nÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹",
                        reply_markup=markup
                    )
                    return

                # Ø§Ø®ØªÙŠØ§Ø± Ø±Ù‚Ù… Ø¹Ø´ÙˆØ§Ø¦ÙŠ
                selected = random.choice(all_numbers)
                number = selected['number']
                source = selected['source']

                # Ø¹Ø±Ø¶ Ø§Ù„Ø±Ù‚Ù…
                display_server2_number(call.message.chat.id, call.message.message_id, country, number, source)

            except Exception as e:
                print(f"Error getting number: {e}")
                markup = telebot.types.InlineKeyboardMarkup()
                markup.add(telebot.types.InlineKeyboardButton(
                    text="ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¯ÙˆÙ„",
                    callback_data="select_server_2"
                ))
                bot.edit_message_text(
                    chat_id=call.message.chat.id,
                    message_id=call.message.message_id,
                    text="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…",
                    reply_markup=markup
                )

        thread = threading.Thread(target=get_random_number)
        thread.daemon = True
        thread.start()

    except Exception as e:
        print(f"Error in server2_country_handler: {e}")

def display_server2_number(chat_id: int, message_id: int, country: Dict, number: str, source: str) -> NoReturn:
    """Display number from server 2"""
    try:
        markup = telebot.types.InlineKeyboardMarkup()
        # ØªÙ‚ØµÙŠØ± URL Ø§Ù„Ù…ØµØ¯Ø± Ù„ØªØ¬Ù†Ø¨ Ø®Ø·Ø£ BUTTON_DATA_INVALID
        source_id = abs(hash(source)) % 10000
        markup.row(
            telebot.types.InlineKeyboardButton(
                text="ğŸ“¨ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„",
                callback_data=f"s2msg&{country['code']}&{source_id}"
            ),
            telebot.types.InlineKeyboardButton(
                text="ğŸ”„ Ø±Ù‚Ù… Ø¢Ø®Ø±",
                callback_data=f"server2_country&{country['code']}"
            )
        )
        markup.add(telebot.types.InlineKeyboardButton(
            text="ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¯ÙˆÙ„",
            callback_data="select_server_2"
        ))
        markup.add(telebot.types.InlineKeyboardButton(
            text="ğŸ  Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
            callback_data="main_menu"
        ))

        order_id = random.randint(100000000, 999999999)
        operation_id = random.randint(1000000000, 9999999999)
        current_time = datetime.now().strftime("%Y-%m-%d %H:%M:%S")

        text = (
            f"â– Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨ | {order_id} ğŸ›â€¢\n"
            f"â– Ø§Ù„Ø¯ÙˆÙ„Ø© | {country['flag']} {country['name']} â€¢\n"
            f"â– Ø§Ù„Ø±Ù‚Ù… | {number} â˜ï¸â€¢\n"
            f"â– Ø§Ù„ÙƒÙˆØ¯ | ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± ğŸ“©â€¢\n"
            f"â– Ø§Ù„Ø­Ø§Ù„Ø© | ğŸŸ¢ Ù…ØªØ§Ø­ ğŸ”â€¢\n"
            f"â– Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ : Ø±Ù‚Ù… ÙˆÙ‡Ù…ÙŠ â€¢\n"
            f"â– Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠØ© : {operation_id} â€¢\n"
            f"â– Ø§Ù„Ø³Ø¹Ø± | 0.00$ ğŸ’™â€¢\n"
            f"â– ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ : {current_time} â€¢ ğŸ“«â€¢\n"
            f"â– ÙŠÙ†ØªÙ‡ÙŠ : 30:00 ğŸ“­â€¢\n"
            f"â– Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª : 1 â€¢"
        )

        bot.edit_message_text(
            chat_id=chat_id,
            message_id=message_id,
            text=text,
            reply_markup=markup
        )
    except Exception as e:
        print(f"Error in display_server2_number: {e}")

@bot.callback_query_handler(func=lambda x: x.data == "show_countries")
def show_countries_handler(call: ClassVar[Any]) -> NoReturn:
    """Callback query handler to show countries list"""
    try:
        bot.edit_message_text(
            chat_id=call.message.chat.id,
            message_id=call.message.message_id,
            text="ğŸ” Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¯ÙˆÙ„ Ø§Ù„Ù…ØªØ§Ø­Ø© âŒ›..."
        )

        def load_countries():
            try:
                send_country_list(call.message.chat.id, call.message.message_id, 0)
            except Exception as e:
                print(f"Error loading countries: {e}")
                bot.edit_message_text(
                    chat_id=call.message.chat.id,
                    message_id=call.message.message_id,
                    text="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯ÙˆÙ„. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰."
                )

        thread = threading.Thread(target=load_countries)
        thread.daemon = True
        thread.start()

    except Exception as e:
        print(f"Error in show_countries_handler: {e}")


@bot.callback_query_handler(func=lambda x: x.data == "show_stats")
def show_stats_handler(call: ClassVar[Any]) -> NoReturn:
    """Callback query handler to show user stats"""
    try:
        markup = telebot.types.InlineKeyboardMarkup()
        markup.add(telebot.types.InlineKeyboardButton(
            text="ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
            callback_data="main_menu"
        ))

        bot.edit_message_text(
            chat_id=call.message.chat.id,
            message_id=call.message.message_id,
            text=(
                "ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ©\n\n"
                f"ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: {call.from_user.first_name}\n"
                f"ğŸ†” Ø§Ù„Ø£ÙŠØ¯ÙŠ: {call.from_user.id}\n"
                f"ğŸ“± Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©: 0\n"
                f"â° ÙˆÙ‚Øª Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…: Ø§Ù„ÙŠÙˆÙ…"
            ),
            reply_markup=markup
        )
        bot.answer_callback_query(call.id)
    except Exception as e:
        print(f"Error in show_stats_handler: {e}")

@bot.callback_query_handler(func=lambda x: x.data == "show_help")
def show_help_handler(call: ClassVar[Any]) -> NoReturn:
    """Callback query handler to show help"""
    try:
        markup = telebot.types.InlineKeyboardMarkup()
        markup.add(telebot.types.InlineKeyboardButton(
            text="ğŸŒ Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆÙ„Ø©",
            callback_data="show_countries"
        ))
        markup.add(telebot.types.InlineKeyboardButton(
            text="ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",
            callback_data="main_menu"
        ))

        bot.edit_message_text(
            chat_id=call.message.chat.id,
            message_id=call.message.message_id,
            text=(
               "Â·á´¥Â· Ø¨ÙˆØª Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ÙˆÙ‡Ù…ÙŠØ©\n\n"
               "Ù‡Ø°Ø§ Ø§Ù„Ø¨ÙˆØª Ù…Ø­Ù…ÙŠ Ø¨Ø­Ù‚ÙˆÙ‚ velkor ÙˆÙŠØ¬Ù„Ø¨ "
               "Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù†Ø´Ø·Ø© ÙˆØ§Ù„Ù…ØªØ§Ø­Ø©.\n\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•\n"
               "â˜… Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆÙ„Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©\n\n"
               "â˜… Ø§Ø®ØªØ± Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…ØªØ§Ø­\n\n"
               "â˜… Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ù„Ø±Ø¤ÙŠØ© Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø©\n\n"
               "â˜… Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± (ÙØ­Øµ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ) Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù‚Ù…\n\n"
               "â˜… Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± (Ø±Ù‚Ù… Ø¬Ø¯ÙŠØ¯) Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø±Ù‚Ù… Ø¢Ø®Ø±\n"
               "â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n"
               "Ù‡Ø°Ø§ ÙƒÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬ Ù…Ø¹Ø±ÙØªÙ‡ Ø¹Ù† Ø§Ù„Ø¨ÙˆØª!"
            ),
            reply_markup=markup
        )
        bot.answer_callback_query(callback_query_id=call.id)
    except Exception as e:
        print(f"Error in show_help_handler: {e}")


@bot.callback_query_handler(func=lambda x: x.data == "main_menu")
def main_menu_handler(call: ClassVar[Any]) -> NoReturn:
    """Callback query handler to show main menu"""
    try:
        user: ClassVar[Union[str, int]] = User(call.from_user)

        markup = telebot.types.InlineKeyboardMarkup()

        # Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¯ÙˆÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹Ø© - Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„
        # Server selection buttons
        markup.row(
            telebot.types.InlineKeyboardButton(
                text="ğŸ”µ Ø³ÙŠØ±ÙØ±",
                callback_data="select_server_1"
            )
        )
        markup.row(
            telebot.types.InlineKeyboardButton(
                text="ğŸŸ¢ Ø³ÙŠØ±ÙØ±",
                callback_data="select_server_2"
            )
        )

        markup.add(telebot.types.InlineKeyboardButton(
            text="â“ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©",
            callback_data="show_help"
        ))

        bot.edit_message_text(
            chat_id=call.message.chat.id,
            message_id=call.message.message_id,
            text=(
                f"â€â´ Ù…Ø±Ø­Ø¨Ø§Ù‹ {user.pn}\n"
                "Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¨ÙˆØª Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ÙˆÙ‡Ù…ÙŠØ© Ø§Ù„Ù…ØªØ·ÙˆØ±\n\n"
                "ğŸ”µ Ø³ÙŠØ±ÙØ± 1: Ø§Ù„Ù…ØªØ·ÙˆØ±\n\n"
                "ğŸ”µ Ø³ÙŠØ±ÙØ± 1:   \n"
                "ğŸŸ¢ Ø³ÙŠØ±ÙØ± 2: ÙŠ\n\n"
                "Ø§Ø®ØªØ± Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ùƒ ğŸ“±"
            ),
            reply_markup=markup
        )
        bot.answer_callback_query(callback_query_id=call.id)
    except Exception as e:
        print(f"Error in main_menu_handler: {e}")


@bot.callback_query_handler(func=lambda x:x.data.startswith("msg"))
def number_inbox_handler(call: ClassVar[Any]) -> NoReturn:
    """Callback query handler to handle inbox messages"""
    try:
        engine: ClassVar[Any] = VNEngine()
        country: str
        number: str
        _, country, number = call.data.split("&")

        try:
            messages: List[Dict[str, str]] = engine.get_number_inbox(country=country, number=number)
        except Exception as e:
            print(f"Error getting inbox: {e}")
            bot.answer_callback_query(callback_query_id=call.id, text="âŒ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…", show_alert=True)
            return

        if not messages:
            bot.answer_callback_query(callback_query_id=call.id, text="âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø³Ø§Ø¦Ù„ ÙÙŠ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„ÙˆØ§Ø±Ø¯", show_alert=True)
            return

        # Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© Ù…Ù† 1-3 Ø¯Ù‚Ø§Ø¦Ù‚
        latest_valid_message = None
        for message in messages:
            for key, value in message.items():
                # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ù† Ø¯Ù‚ÙŠÙ‚Ø© Ø¥Ù„Ù‰ 3 Ø¯Ù‚Ø§Ø¦Ù‚
                if "Ø¯Ù‚ÙŠÙ‚Ø©" in key or "minute" in key.lower():
                    # Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø±Ù‚Ù… Ù…Ù† Ø§Ù„Ù†Øµ
                    numbers = re.findall(r'\d+', key)
                    if numbers:
                        minutes = int(numbers[0])
                        if 1 <= minutes <= 3:
                            latest_valid_message = {key: value}
                            break
            if latest_valid_message:
                break

        if not latest_valid_message:
            bot.answer_callback_query(
                callback_query_id=call.id,
                text="âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø³Ø§Ø¦Ù„ Ù…Ù† Ø¢Ø®Ø± 1-3 Ø¯Ù‚Ø§Ø¦Ù‚",
                show_alert=True
            )
            return

        # Ø¹Ø±Ø¶ Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© ÙÙ‚Ø·
        for key, value in latest_valid_message.items():
            bot.send_message(
                chat_id=call.message.chat.id,
                reply_to_message_id=call.message.message_id,
                text=(f"âš¯Í› Ø§Ù„ÙˆÙ‚Øª: {key}\n\n{value.split('received from OnlineSIM.io')[0]}")
            )

        bot.answer_callback_query(
            callback_query_id=call.id,
            text="âœ… ØªÙ… Ø¹Ø±Ø¶ Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© Ù…Ù† 1-3 Ø¯Ù‚Ø§Ø¦Ù‚",
            show_alert=True
        )
    except Exception as e:
        print(f"Error in number_inbox_handler: {e}")
        try:
            bot.answer_callback_query(callback_query_id=call.id, text="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„", show_alert=True)
        except:
            pass


@bot.callback_query_handler(func=lambda x: x.data.startswith("another_number"))
def another_number_handler(call: ClassVar[Any]) -> NoReturn:
    """Callback query handler to get another random number from same country"""
    try:
        _, country_name = call.data.split("&")
        bot.edit_message_text(
            chat_id=call.message.chat.id,
            message_id=call.message.message_id,
            text=f"ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªÙŠØ§Ø± Ø±Ù‚Ù… Ø¢Ø®Ø± Ù…Ù† {country_name.replace('_', ' ').title()}..."
        )

        def select_new_random_number():
            try:
                engine = VNEngine()
                numbers = engine.get_country_numbers(country=country_name)

                if not numbers:
                    markup = telebot.types.InlineKeyboardMarkup()
                    markup.add(telebot.types.InlineKeyboardButton(
                        text="ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¯ÙˆÙ„",
                        callback_data="back_to_countries"
                    ))
                    bot.edit_message_text(
                        chat_id=call.message.chat.id,
                        message_id=call.message.message_id,
                        text=f"âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø±Ù‚Ø§Ù… Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹ ÙÙŠ {country_name.replace('_', ' ').title()}",
                        reply_markup=markup
                    )
                    return

                # Ø§Ø®ØªÙŠØ§Ø± Ø±Ù‚Ù… Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø¬Ø¯ÙŠØ¯
                random_number = random.choice(numbers)
                number = random_number[1]

                # Ø¹Ø±Ø¶ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
                display_selected_number(call.message.chat.id, call.message.message_id, country_name, number)

            except Exception as e:
                print(f"Error selecting new random number: {e}")
                try:
                    bot.edit_message_text(
                        chat_id=call.message.chat.id,
                        message_id=call.message.message_id,
                        text="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ø®ØªÙŠØ§Ø± Ø±Ù‚Ù… Ø¬Ø¯ÙŠØ¯"
                    )
                except:
                    pass

        thread = threading.Thread(target=select_new_random_number)
        thread.daemon = True
        thread.start()

        bot.answer_callback_query(callback_query_id=call.id, text="ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªÙŠØ§Ø± Ø±Ù‚Ù… Ø¢Ø®Ø±...")
    except Exception as e:
        print(f"Error in another_number_handler: {e}")
        try:
            bot.answer_callback_query(callback_query_id=call.id, text="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£")
        except:
            pass


@bot.callback_query_handler(func=lambda x:x.data == "new_phone_number")
def new_number_handler(call):
    """Callback query handler to select new country"""
    try:
        bot.edit_message_text(
            chat_id=call.message.chat.id,
            message_id=call.message.message_id,
            text="ğŸ” Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¯ÙˆÙ„ Ø§Ù„Ù…ØªØ§Ø­Ø© âŒ›..."
        )

        def load_countries():
            try:
                send_country_list(call.message.chat.id, call.message.message_id, 0)
            except Exception as e:
                print(f"Error loading countries: {e}")
                bot.edit_message_text(
                    chat_id=call.message.chat.id,
                    message_id=call.message.message_id,
                    text="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯ÙˆÙ„. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰."
                )

        thread = threading.Thread(target=load_countries)
        thread.daemon = True
        thread.start()

        bot.answer_callback_query(callback_query_id=call.id, text="Ø§Ø®ØªØ± Ø¯ÙˆÙ„Ø© Ø¬Ø¯ÙŠØ¯Ø© ğŸŒ")

    except Exception as e:
        print(f"Error in new_number_handler: {e}")
        try:
            bot.answer_callback_query(callback_query_id=call.id, text="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£", show_alert=True)
        except:
            pass


# ============= Run Bot =============
if __name__ == '__main__':
    try:
        bot.infinity_polling(skip_pending=True)
    except KeyboardInterrupt:
        raise SystemExit("\n\33[1;31m::\33[m Terminated by user")
